"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9301],{4416:(E,P,a)=>{a.d(P,{l:()=>v});var t=a(4438),m=a(9598),s=a(4742),I=a(177),p=a(230);const d=["*"];function T(g,M){if(1&g&&(t.j41(0,"ion-buttons",5),t.nrm(1,"ion-back-button",6),t.nI1(2,"translate"),t.k0s()),2&g){const h=t.XpG();t.R7$(),t.FS9("text",t.bMT(2,2,"BACK")),t.Y8G("defaultHref",h.backPage)}}function f(g,M){1&g&&(t.j41(0,"ion-menu-toggle",5)(1,"ion-button",7),t.nrm(2,"ion-icon",8),t.k0s()())}function e(g,M){if(1&g&&(t.j41(0,"ion-title"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&g){const h=t.XpG();t.R7$(),t.SpI(" ",t.bMT(2,1,h.pageTitle)," ")}}let v=(()=>{var g;class M{constructor(N){this.router=N,this.backPage=""}navToMyAccount(){this.router.navigate(["my-account"])}}return(g=M).\u0275fac=function(N){return new(N||g)(t.rXU(m.Ix))},g.\u0275cmp=t.VBU({type:g,selectors:[["app-header"]],inputs:{pageTitle:"pageTitle",backPage:"backPage"},ngContentSelectors:d,decls:9,vars:3,consts:[["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end"],[3,"click"],["name","cog"],["slot","start"],[3,"defaultHref","text"],["size","small","fill","clear"],["name","menu"]],template:function(N,B){1&N&&(t.NAR(),t.j41(0,"ion-header")(1,"ion-toolbar"),t.DNE(2,T,3,4,"ion-buttons",0)(3,f,3,0,"ion-menu-toggle",0)(4,e,3,3,"ion-title",1),t.j41(5,"ion-buttons",2)(6,"ion-button",3),t.bIt("click",function(){return B.navToMyAccount()}),t.nrm(7,"ion-icon",4),t.k0s()()()(),t.SdG(8)),2&N&&(t.R7$(2),t.Y8G("ngIf",B.backPage),t.R7$(),t.Y8G("ngIf",!B.backPage),t.R7$(),t.Y8G("ngIf",!B.isLoadingUserInfo))},dependencies:[s.Jm,s.QW,s.eU,s.iq,s.cA,s.BC,s.ai,s.el,I.bT,p.D9]}),M})()},2952:(E,P,a)=>{a.d(P,{t:()=>p});var t=a(4438),m=a(4742),s=a(177);function I(d,T){if(1&d&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&d){const f=t.XpG();t.R7$(),t.JRh(f.text)}}let p=(()=>{var d;class T{constructor(){this.text=""}}return(d=T).\u0275fac=function(e){return new(e||d)},d.\u0275cmp=t.VBU({type:d,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(e,v){2&e&&t.HbH(v.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(e,v){1&e&&(t.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),t.nrm(3,"ion-spinner"),t.DNE(4,I,2,1,"p",3),t.k0s()()()),2&e&&(t.R7$(4),t.Y8G("ngIf",v.text))},dependencies:[m.hU,m.lO,m.ln,m.w2,s.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),T})()},9301:(E,P,a)=>{a.r(P),a.d(P,{NoticeBoardPageModule:()=>H});var t=a(177),m=a(9417),s=a(4742),I=a(9598),p=a(467),d=a(5383),T=a(3207),f=a(6090),e=a(4438),v=a(1204),g=a(7760),M=a(5151),h=a(9196),N=a(4078),B=a(230),S=a(4416),R=a(2952),y=a(60);function F(o,l){1&o&&(e.j41(0,"div",12),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"NOTICE_BOARD_NO_UNREAD_MESSAGES")," "))}function O(o,l){if(1&o){const i=e.RV6();e.j41(0,"ion-item",13),e.bIt("click",function(){const r=e.eBV(i).$implicit,c=e.XpG(3);return e.Njj(c.openNotice(r))}),e.j41(1,"ion-label")(2,"h2"),e.nrm(3,"fa-icon",14),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.nI1(11,"translate"),e.k0s()()()}if(2&o){const i=l.$implicit,n=e.XpG(3);e.R7$(3),e.Y8G("icon",n.getFaIcon(i.icon)),e.R7$(),e.SpI(" ",i.title," "),e.R7$(2),e.SpI("Fr\xe5n: ",n.getSender(i),""),e.R7$(2),e.SpI("Till: ",n.getClassName(i),""),e.R7$(2),e.Lme("",e.bMT(11,6,"PUBLISHED")," ",n.getTime(i),"")}}function x(o,l){if(1&o&&(e.qex(0),e.DNE(1,F,3,3,"div",10),e.j41(2,"ion-list"),e.DNE(3,O,12,8,"ion-item",11),e.k0s(),e.bVm()),2&o){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",!i.isBusy&&!i.hasUnreadMessages),e.R7$(2),e.Y8G("ngForOf",i.noticeBoard.unreadNotices)}}function D(o,l){1&o&&(e.j41(0,"div",12),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"NOTICE_BOARD_NO_MESSAGES")," "))}function $(o,l){if(1&o){const i=e.RV6();e.j41(0,"ion-item",13),e.bIt("click",function(){const r=e.eBV(i).$implicit,c=e.XpG(3);return e.Njj(c.openNotice(r))}),e.j41(1,"ion-label")(2,"h2"),e.nrm(3,"fa-icon",14),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.nI1(11,"translate"),e.k0s()()()}if(2&o){const i=l.$implicit,n=e.XpG(3);e.R7$(3),e.Y8G("icon",n.getFaIcon(i.icon)),e.R7$(),e.SpI(" ",i.title," "),e.R7$(2),e.SpI("Fr\xe5n: ",n.getSender(i),""),e.R7$(2),e.SpI("Till: ",n.getClassName(i),""),e.R7$(2),e.Lme("",e.bMT(11,6,"PUBLISHED")," ",n.getTime(i),"")}}function j(o,l){if(1&o&&(e.qex(0),e.DNE(1,D,3,3,"div",10),e.j41(2,"ion-list"),e.DNE(3,$,12,8,"ion-item",11),e.k0s(),e.bVm()),2&o){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",!i.isBusy&&!i.hasMessages),e.R7$(2),e.Y8G("ngForOf",i.noticeBoard.allNotices)}}function A(o,l){1&o&&e.nrm(0,"q-spinner",15)}function U(o,l){if(1&o){const i=e.RV6();e.j41(0,"ion-button",16),e.bIt("click",function(){e.eBV(i);const r=e.XpG(2);return e.Njj(r.onClickLoadMore())}),e.nrm(1,"ion-icon",17),e.k0s()}}function G(o,l){if(1&o){const i=e.RV6();e.qex(0),e.j41(1,"div",3)(2,"ion-segment",4),e.mxI("ngModelChange",function(r){e.eBV(i);const c=e.XpG();return e.DH7(c.listType,r)||(c.listType=r),e.Njj(r)}),e.j41(3,"ion-segment-button",5),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"ion-segment-button",6),e.EFF(7),e.nI1(8,"translate"),e.k0s()()(),e.DNE(9,x,4,2,"ng-container",2)(10,j,4,2,"ng-container",2),e.j41(11,"div",7),e.DNE(12,A,1,0,"q-spinner",8)(13,U,2,0,"ion-button",9),e.k0s(),e.bVm()}if(2&o){const i=e.XpG();e.R7$(2),e.R50("ngModel",i.listType),e.R7$(2),e.SpI(" ",e.bMT(5,7,"UNREAD")," "),e.R7$(3),e.SpI(" ",e.bMT(8,9,"ALL")," "),e.R7$(2),e.Y8G("ngIf","unread"==i.listType),e.R7$(),e.Y8G("ngIf","all"==i.listType),e.R7$(2),e.Y8G("ngIf",i.isLoadingMore),e.R7$(),e.Y8G("ngIf",i.canLoadMore&&!i.isLoadingMore)}}const b=[{path:"",component:(()=>{var o;class l extends f.v{constructor(n,r,c,_,u,C,V,Y,K){super(n,c,r,K,u,C),this.noticeBoard=_,this.userInfo=C,this.errorHandler=V,this.dateService=Y,this.isBusy=!0,this.isLoadingMore=!1,this.listType="unread",this.faBell=d.z$e,this.faBullhorn=d.e4L}get canLoadMore(){return"unread"===this.listType&&this.noticeBoard.hasMoreUnread||"all"===this.listType&&this.noticeBoard.hasMore}get hasUnreadMessages(){return this.noticeBoard&&this.noticeBoard.unreadNotices&&this.noticeBoard.unreadNotices.length>0}get hasMessages(){return this.noticeBoard&&this.noticeBoard.allNotices&&this.noticeBoard.allNotices.length>0}getSender(n){let r=n.senderName||n.creatorName;return n.schoolName&&(r+=", "+n.schoolName),r}getClassName(n){var r;const c=this.noticeBoard.allNotices.find(u=>u.noticeId===n.noticeId);let _="";return null!=c&&null!==(r=c.recipientSet)&&void 0!==r&&r.className&&(_=c.recipientSet.className),_}getSchoolSender(n){var r=this;return(0,p.A)(function*(){try{const c=yield r.noticeBoard.getSchoolSender(n.recipientSet.userSetId);if(Array.isArray(c))return c.join(", ");throw new Error("Unexpected response format")}catch(c){return console.error("Failed to get school sender:",c),"-"}})()}getTime(n){return this.dateService.formatDateIso8601(n.publishStart)}ionViewWillEnter(){var n=this;return(0,p.A)(function*(){const r=yield(0,T.s)(n.translateService.get(["NOTICE_BOARD_LOADING_NOTICES"]));n.withSpinner(()=>n.initView(),r.NOTICE_BOARD_LOADING_NOTICES)})()}onClickLoadMore(){var n=this;return(0,p.A)(function*(){n.isLoadingMore=!0,yield n.loadMore(),yield n.updateSchoolNamesForNotices(),n.isLoadingMore=!1})()}openNotice(n){this.navTo(["tabs","notice-board",n.noticeId],{state:{notice:n,backToPage:"tabs/notice-board"}})}refresh(n){var r=this;return(0,p.A)(function*(){try{"all"===r.listType?yield r.noticeBoard.refreshAll():yield r.noticeBoard.refreshUnread()}catch(c){r.errorHandler.handleError("Kunde inte ladda nyheter")}finally{console.log("finally"),yield r.updateSchoolNamesForNotices(),yield r.updateSchoolNamesForUnreadNotices(),n.target.complete()}})()}initView(){var n=this;return(0,p.A)(function*(){n.isBusy=!0,yield n.noticeBoard.refreshAll(),yield n.noticeBoard.refreshUnread(),n.updateSchoolNamesForNotices(),yield n.updateSchoolNamesForUnreadNotices(),n.isBusy=!1})()}updateSchoolNamesForNotices(){var n=this;return(0,p.A)(function*(){try{const r=n.noticeBoard.allNotices.map(function(){var c=(0,p.A)(function*(_){const{recipientSet:u}=_;null!=u&&u.userSetId&&!u.className&&(u.className=yield n.getSchoolSender(_))});return function(_){return c.apply(this,arguments)}}());yield Promise.all(r)}catch(r){console.error("Error updating school names for notices:",r)}})()}updateSchoolNamesForUnreadNotices(){var n=this;return(0,p.A)(function*(){try{const r=n.noticeBoard.unreadNotices.map(function(){var c=(0,p.A)(function*(_){const{recipientSet:u}=_;null!=u&&u.userSetId&&!u.className&&(u.className=yield n.getSchoolSender(_))});return function(_){return c.apply(this,arguments)}}());yield Promise.all(r)}catch(r){console.error("Error updating school names for notices:",r)}})()}loadMore(){if("unread"===this.listType){const n=this.noticeBoard.loadNextPageOfUnread();return this.updateSchoolNamesForNotices(),n}{const n=this.noticeBoard.loadNextPageOfAll();return this.updateSchoolNamesForNotices(),n}}getFaIcon(n){switch(n){case"fa-bell":default:return d.z$e;case"fa-bullhorn":return d.e4L}}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(v.$),e.rXU(s.Xi),e.rXU(I.Ix),e.rXU(g.O),e.rXU(M.p),e.rXU(h.Z),e.rXU(e.zcH),e.rXU(N.k),e.rXU(B.c$))},o.\u0275cmp=e.VBU({type:o,selectors:[["page-notice-board"]],features:[e.Vt3],decls:6,vars:4,consts:[[3,"pageTitle"],["slot","fixed",3,"ionRefresh"],[4,"ngIf"],[1,"ion-padding"],["color","action",3,"ngModelChange","ngModel"],["value","unread"],["value","all"],[1,"ion-text-center"],["margin-top","",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],["class","ion-padding ion-text-center",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"ion-padding","ion-text-center"],[3,"click"],[3,"icon"],["margin-top",""],["fill","clear",3,"click"],["name","ellipsis-horizontal-outline"]],template:function(n,r){1&n&&(e.nrm(0,"app-header",0),e.nI1(1,"translate"),e.j41(2,"ion-content")(3,"ion-refresher",1),e.bIt("ionRefresh",function(_){return r.refresh(_)}),e.nrm(4,"ion-refresher-content"),e.k0s(),e.DNE(5,G,14,11,"ng-container",2),e.k0s()),2&n&&(e.FS9("pageTitle",e.bMT(1,2,"NOTICE_BOARD_TITLE")),e.R7$(5),e.Y8G("ngIf",!r.isBusy))},dependencies:[t.Sq,t.bT,m.BC,m.vS,s.Jm,s.W9,s.iq,s.uz,s.he,s.nf,s.To,s.Ki,s.Gp,s.eP,s.Je,S.l,R.t,y.aY,B.D9],styles:["h2[_ngcontent-%COMP%]{color:var(--quiculum-gray)}h2[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{margin-right:.5em}"]}),l})()}];let L=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[I.iI.forChild(b),I.iI]}),l})();var k=a(7019),X=a(1683);let H=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD,m.YN,s.bv,L,k.h,B.h,X.Y,y.dX]}),l})()}}]);