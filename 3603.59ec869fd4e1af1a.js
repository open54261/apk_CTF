"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3603],{1916:(N,I,r)=>{r.d(I,{$:()=>A});var s=r(467),l=r(3207),a=r(4438),R=r(4742),u=r(230),_=r(5151);let A=(()=>{var e;class P{constructor(p,g,d){this.loadingCtrl=p,this.translateService=g,this.userAlertService=d,this.subscriptions=[],this.showLoading=!1,this.loadingDismissTimeout=-1,this.loadingDismissTimeoutMS=3e4}ngOnDestroy(){this.subscriptions.forEach(p=>p.unsubscribe())}addSub(p){this.subscriptions.push(p)}translate(p,g){var d=this;return(0,s.A)(function*(){return(yield(0,l.s)(d.translateService.get(p)))||g||p})()}withSpinner(p,g,d){var h=this;return(0,s.A)(function*(){let T;yield h.presentLoading(g),h.loadingDismissTimeout=setTimeout(()=>h.timeoutLoading(d),h.loadingDismissTimeoutMS);try{T=yield p()}catch(O){h.userAlertService.debug(O)}return yield h.dismissLoading(),T})()}timeoutLoading(p){var g=this;return(0,s.A)(function*(){p||(p=yield g.translate("LOADING_FAILED")),g.userAlertService.error(p),yield g.dismissLoading()})()}dismissLoading(){var p=this;return(0,s.A)(function*(){-1!=p.loadingDismissTimeout&&(clearTimeout(p.loadingDismissTimeout),p.loadingDismissTimeout=-1),p.showLoading=!1,(yield p.loadingCtrl.getTop())&&(yield p.loadingCtrl.dismiss(null))})()}presentLoading(p){var g=this;return(0,s.A)(function*(){return g.showLoading=!0,yield g.loadingCtrl.create({message:p}).then(d=>{d.present().then(()=>{g.showLoading&&d.dismiss()})})})()}}return(e=P).\u0275fac=function(p){return new(p||e)(a.rXU(R.Xi),a.rXU(u.c$),a.rXU(_.p))},e.\u0275cmp=a.VBU({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(p,g){},encapsulation:2}),P})()},4416:(N,I,r)=>{r.d(I,{l:()=>f});var s=r(4438),l=r(9598),a=r(4742),R=r(177),u=r(230);const _=["*"];function A(p,g){if(1&p&&(s.j41(0,"ion-buttons",5),s.nrm(1,"ion-back-button",6),s.nI1(2,"translate"),s.k0s()),2&p){const d=s.XpG();s.R7$(),s.FS9("text",s.bMT(2,2,"BACK")),s.Y8G("defaultHref",d.backPage)}}function e(p,g){1&p&&(s.j41(0,"ion-menu-toggle",5)(1,"ion-button",7),s.nrm(2,"ion-icon",8),s.k0s()())}function P(p,g){if(1&p&&(s.j41(0,"ion-title"),s.EFF(1),s.nI1(2,"translate"),s.k0s()),2&p){const d=s.XpG();s.R7$(),s.SpI(" ",s.bMT(2,1,d.pageTitle)," ")}}let f=(()=>{var p;class g{constructor(h){this.router=h,this.backPage=""}navToMyAccount(){this.router.navigate(["my-account"])}}return(p=g).\u0275fac=function(h){return new(h||p)(s.rXU(l.Ix))},p.\u0275cmp=s.VBU({type:p,selectors:[["app-header"]],inputs:{pageTitle:"pageTitle",backPage:"backPage"},ngContentSelectors:_,decls:9,vars:3,consts:[["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end"],[3,"click"],["name","cog"],["slot","start"],[3,"defaultHref","text"],["size","small","fill","clear"],["name","menu"]],template:function(h,T){1&h&&(s.NAR(),s.j41(0,"ion-header")(1,"ion-toolbar"),s.DNE(2,A,3,4,"ion-buttons",0)(3,e,3,0,"ion-menu-toggle",0)(4,P,3,3,"ion-title",1),s.j41(5,"ion-buttons",2)(6,"ion-button",3),s.bIt("click",function(){return T.navToMyAccount()}),s.nrm(7,"ion-icon",4),s.k0s()()()(),s.SdG(8)),2&h&&(s.R7$(2),s.Y8G("ngIf",T.backPage),s.R7$(),s.Y8G("ngIf",!T.backPage),s.R7$(),s.Y8G("ngIf",!T.isLoadingUserInfo))},dependencies:[a.Jm,a.QW,a.eU,a.iq,a.cA,a.BC,a.ai,a.el,R.bT,u.D9]}),g})()},2952:(N,I,r)=>{r.d(I,{t:()=>u});var s=r(4438),l=r(4742),a=r(177);function R(_,A){if(1&_&&(s.j41(0,"p"),s.EFF(1),s.k0s()),2&_){const e=s.XpG();s.R7$(),s.JRh(e.text)}}let u=(()=>{var _;class A{constructor(){this.text=""}}return(_=A).\u0275fac=function(P){return new(P||_)},_.\u0275cmp=s.VBU({type:_,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(P,f){2&P&&s.HbH(f.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(P,f){1&P&&(s.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),s.nrm(3,"ion-spinner"),s.DNE(4,R,2,1,"p",3),s.k0s()()()),2&P&&(s.R7$(4),s.Y8G("ngIf",f.text))},dependencies:[l.hU,l.lO,l.ln,l.w2,a.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),A})()},3603:(N,I,r)=>{r.r(I),r.d(I,{AppointmentsPageModule:()=>de});var s=r(177),l=r(9417),a=r(4742),R=r(9598),u=r(467),_=r(6090),A=r(3207),e=r(4438),P=r(1204),f=r(230),p=r(5151),g=r(9196),d=r(2129),h=r(6244),T=r(6186);let O=(()=>{var t;class c extends d.h{constructor(n,o){super(n,o),this.listEndpoint="/api/appointmentrequests",this.respondEndpoint="/api/appointmentrequests/{appointmentRequestId}/respond",this.updateResponseEndpoint="/api/appointmentrequests/{appointmentRequestId}/updateresponse"}respond(n){var o=this;return(0,u.A)(function*(){let m=o.respondEndpoint.replace("{appointmentRequestId}",n.appointmentRequestId.toString());yield o.api.postJson(m,n),o.refresh()})()}updateResponse(n){var o=this;return(0,u.A)(function*(){let m=o.updateResponseEndpoint.replace("{appointmentRequestId}",n.appointmentRequestId.toString());yield o.api.postJson(m,n),o.refresh()})()}loadList(){return super.loadList({includeAllSchools:!0,includeOnlyCurrent:!0})}}return(t=c).\u0275fac=function(n){return new(n||t)(e.KVO(h.j),e.KVO(T.B))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),c})();var B=r(4416),v=r(2952),U=r(1916),C=r(7583),L=r(7143);let G=(()=>{var t;class c{transform(n,...o){return"string"==typeof n?n.toLowerCase():""}}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275pipe=e.EJ8({name:"lower",type:t,pure:!0}),c})();var q=r(4078);let S=(()=>{var t;class c{constructor(n){this.dateService=n}transform(n,...o){return n?this.dateService.formatDayAndDateShort(n):""}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(q.k,16))},t.\u0275pipe=e.EJ8({name:"qDayAndDateShort",type:t,pure:!0}),c})();function x(t,c){1&t&&e.nrm(0,"q-spinner")}function b(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-icon",7),e.bIt("click",function(){e.eBV(i);const o=e.XpG(4);return e.Njj(o.confirmCancelAppointment())}),e.k0s()}}function $(t,c){if(1&t&&(e.j41(0,"ion-item",4)(1,"ion-label")(2,"div",5),e.EFF(3),e.nI1(4,"qDayAndDateShort"),e.nI1(5,"qTime"),e.k0s(),e.j41(6,"div"),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.DNE(9,b,1,0,"ion-icon",6),e.k0s()),2&t){const i=e.XpG(3);e.R7$(3),e.Lme(" ",e.bMT(4,5,i.bookedAppointment.date)," ",e.bMT(5,7,i.bookedAppointment.startTime)," "),e.R7$(4),e.Lme(" ",e.bMT(8,9,"APPOINTMENT_LOCATION"),": ",i.bookedAppointment.locationName," "),e.R7$(2),e.Y8G("ngIf",i.hasAccepted)}}function k(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-button",8),e.bIt("click",function(){e.eBV(i);const o=e.XpG(3);return e.Njj(o.view="PickTime")}),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"translate"),e.nI1(4,"lower"),e.k0s()}2&t&&(e.R7$(),e.Lme(" ",e.bMT(2,2,"PICK")," ",e.bMT(4,6,e.bMT(3,4,"TIME"))," "))}function F(t,c){if(1&t&&(e.qex(0),e.DNE(1,$,10,11,"ion-item",1),e.j41(2,"div",2),e.DNE(3,k,5,8,"ion-button",3),e.k0s(),e.bVm()),2&t){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",i.bookedAppointment),e.R7$(2),e.Y8G("ngIf",!i.hasAppointment)}}function j(t,c){if(1&t&&(e.j41(0,"ion-card-content")(1,"p"),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.DNE(6,x,1,0,"q-spinner",0)(7,F,4,2,"ng-container",0),e.k0s()),2&t){const i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,5,"SENT_BY")," ",i.creatorName,""),e.R7$(3),e.JRh(i.request.description),e.R7$(),e.Y8G("ngIf",i.isBusy),e.R7$(),e.Y8G("ngIf",!i.isBusy)}}function V(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.nI1(3,"qDayAndDate"),e.nI1(4,"qTime"),e.k0s(),e.j41(5,"ion-checkbox",12),e.bIt("click",function(){const o=e.eBV(i).$implicit,m=e.XpG(2);return e.Njj(m.confirmBookAppointment(o))}),e.k0s()()}if(2&t){const i=c.$implicit,n=e.XpG(2);e.R7$(2),e.Lme("",e.bMT(3,4,i.date)," ",e.bMT(4,6,i.startTime),""),e.R7$(3),e.Y8G("checked",n.isBooked(i))("disabled",n.isBooked(i))}}function K(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-list")(1,"div",9)(2,"ion-icon",10),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.view="Request")}),e.k0s()(),e.DNE(3,V,6,8,"ion-item",11),e.k0s()}if(2&t){const i=e.XpG();e.R7$(3),e.Y8G("ngForOf",null==i.request?null:i.request.appointments)}}let X=(()=>{var t;class c extends U.${constructor(n,o,m,E,M){super(n,o,m),this.alertCtrl=E,this.cdRef=M,this.cancelAppointment=new e.bkB,this.pickAppointment=new e.bkB,this.isBusy=!1,this.view="Request"}confirmBookAppointment(n){var o=this;return(0,u.A)(function*(){let m=yield(0,A.s)(o.translateService.get(["APPOINTMENT_CONFIRM_BOOK_TITLE","APPOINTMENT_CONFIRM_BOOK_TEXT","NO","YES"]));(yield o.alertCtrl.create({header:m.APPOINTMENT_CONFIRM_BOOK_TITLE,message:m.APPOINTMENT_CONFIRM_BOOK_TEXT.replace("##time##",n.startTime),buttons:[{text:m.NO,handler:()=>o.cdRef.markForCheck()},{text:m.YES,handler:()=>{o.pickAppointment.emit(n),o.view="Request",o.isBusy=!0}}]})).present()})()}confirmCancelAppointment(){var n=this;return(0,u.A)(function*(){let o=yield(0,A.s)(n.translateService.get(["APPOINTMENT_CONFIRM_CANCEL","APPOINTMENT_CONFIRM_CANCEL_TITLE","YES","CANCEL"]));(yield n.alertCtrl.create({header:o.APPOINTMENT_CONFIRM_CANCEL_TITLE,message:o.APPOINTMENT_CONFIRM_CANCEL,buttons:[{text:o.CANCEL},{text:o.YES,handler:()=>n.cancelAppointment.emit(n.bookedAppointment)}]})).present()})()}pickTime(){this.view="PickTime"}get hasAccepted(){return"Accepted"==this.response}get hasAppointment(){return this.request&&this.request.studentUser&&this.request.appointments.some(n=>n.participants.some(o=>o.userId==this.request.studentUser.id))}get creatorName(){return this.request&&this.request.creator?`${this.request.creator.firstName} ${this.request.creator.lastName}`:""}get studentName(){return this.request&&this.request.studentUser?`${this.request.studentUser.firstName} ${this.request.studentUser.lastName}`:""}get response(){return this.receiver?this.receiver.appointmentResponse:"NotResponded"}isBooked(n){return n.participants.length>0}get bookedAppointment(){return this.request.appointments.find(n=>!!n.participants.find(o=>o.userId==this.request.studentUser.userId))}get receiver(){if(this.request&&this.request.receivers){let n=this.request.receivers.find(o=>o.userId==this.request.studentUser.userId);if(n)return n}return null}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(a.Xi),e.rXU(f.c$),e.rXU(p.p),e.rXU(a.hG),e.rXU(e.gRc))},t.\u0275cmp=e.VBU({type:t,selectors:[["parent-teacher-appointment-request"]],inputs:{request:"request"},outputs:{cancelAppointment:"cancelAppointment",pickAppointment:"pickAppointment"},features:[e.Vt3],decls:8,vars:6,consts:[[4,"ngIf"],["class","ion-no-padding","lines","none",4,"ngIf"],[1,"ion-text-right"],[3,"click",4,"ngIf"],["lines","none",1,"ion-no-padding"],[1,"time"],["slot","end","color","danger","name","remove-circle",3,"click",4,"ngIf"],["slot","end","color","danger","name","remove-circle",3,"click"],[3,"click"],[1,"ion-padding-end","ion-text-right"],["name","arrow-dropup",3,"click"],[4,"ngFor","ngForOf"],[3,"click","checked","disabled"]],template:function(n,o){1&n&&(e.j41(0,"ion-card")(1,"ion-card-header"),e.EFF(2),e.nI1(3,"translate"),e.nrm(4,"br"),e.EFF(5),e.k0s(),e.DNE(6,j,8,7,"ion-card-content",0)(7,K,4,1,"ion-list",0),e.k0s()),2&n&&(e.R7$(2),e.SpI(" ",e.bMT(3,4,o.request.appointmentType),""),e.R7$(3),e.SpI(" ",o.studentName," "),e.R7$(),e.Y8G("ngIf","Request"==o.view),e.R7$(),e.Y8G("ngIf","PickTime"==o.view))},dependencies:[a.Jm,a.b_,a.I9,a.ME,a.eY,a.iq,a.uz,a.he,a.nf,a.hB,s.Sq,s.bT,v.t,C.K,L.k,G,S,f.D9],styles:[".time[_ngcontent-%COMP%]{text-transform:capitalize}ion-icon[_ngcontent-%COMP%]{font-size:2em}"]}),c})();var W=r(8775);function Y(t,c){1&t&&e.nrm(0,"q-spinner")}function H(t,c){1&t&&(e.j41(0,"ion-badge",9),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(),e.JRh(e.bMT(2,1,"APPOINTMENT_ACCEPTED")))}function J(t,c){1&t&&(e.j41(0,"ion-badge",10),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(),e.JRh(e.bMT(2,1,"APPOINTMENT_DECLINED")))}function z(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-col",11)(1,"a",12),e.bIt("click",function(){e.eBV(i);const o=e.XpG(4);return e.Njj(o.isUpdatingResponse=!0)}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}2&t&&(e.R7$(2),e.JRh(e.bMT(3,1,"APPOINTMENT_UPDATE_RESPONSE")))}function w(t,c){if(1&t&&(e.j41(0,"ion-grid",6)(1,"ion-row")(2,"ion-col"),e.DNE(3,H,3,3,"ion-badge",7)(4,J,3,3,"ion-badge",8),e.k0s(),e.DNE(5,z,4,3,"ion-col",5),e.k0s()()),2&t){const i=e.XpG(3);e.R7$(3),e.Y8G("ngIf","Accepted"==i.response),e.R7$(),e.Y8G("ngIf","Declined"==i.response),e.R7$(),e.Y8G("ngIf",!i.isUpdatingResponse)}}function Z(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-button",16),e.bIt("click",function(){e.eBV(i);const o=e.XpG(4);return e.Njj(o.decline())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&t&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"APPOINTMENT_DECLINE")," "))}function Q(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-button",17),e.bIt("click",function(){e.eBV(i);const o=e.XpG(4);return e.Njj(o.accept())}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&t&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"APPOINTMENT_ACCEPT")," "))}function ee(t,c){if(1&t){const i=e.RV6();e.j41(0,"ion-button",18),e.bIt("click",function(){e.eBV(i);const o=e.XpG(4);return e.Njj(o.isUpdatingResponse=!1)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&t&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"CANCEL")," "))}function te(t,c){if(1&t&&(e.j41(0,"div",11),e.DNE(1,Z,3,3,"ion-button",13)(2,Q,3,3,"ion-button",14)(3,ee,3,3,"ion-button",15),e.k0s()),2&t){const i=e.XpG(3);e.R7$(),e.Y8G("ngIf",!i.hasResponded||"Accepted"==i.response),e.R7$(),e.Y8G("ngIf",!i.hasResponded||"Declined"==i.response),e.R7$(),e.Y8G("ngIf",i.isUpdatingResponse)}}function ne(t,c){if(1&t&&(e.qex(0),e.DNE(1,w,6,3,"ion-grid",4)(2,te,4,3,"div",5),e.bVm()),2&t){const i=e.XpG(2);e.R7$(),e.Y8G("ngIf",i.hasResponded),e.R7$(),e.Y8G("ngIf",!i.hasResponded||i.isUpdatingResponse)}}function ie(t,c){if(1&t&&(e.j41(0,"ion-card-content")(1,"div",1),e.EFF(2),e.nI1(3,"qDayAndDate"),e.nI1(4,"qTime"),e.k0s(),e.j41(5,"div"),e.EFF(6),e.nI1(7,"translate"),e.k0s(),e.j41(8,"p",2),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.nrm(11,"p",3),e.nI1(12,"nlHtml"),e.DNE(13,Y,1,0,"q-spinner",0)(14,ne,3,2,"ng-container",0),e.k0s()),2&t){const i=e.XpG();e.R7$(2),e.Lme("",e.bMT(3,9,i.appointment.date)," ",e.bMT(4,11,i.appointment.startTime),""),e.R7$(4),e.Lme("",e.bMT(7,13,"APPOINTMENT_LOCATION"),": ",i.appointment.location,""),e.R7$(3),e.Lme("",e.bMT(10,15,"SENT_BY")," ",i.creatorName,""),e.R7$(2),e.Y8G("innerHtml",e.bMT(12,17,i.request.description),e.npT),e.R7$(2),e.Y8G("ngIf",i.isBusy),e.R7$(),e.Y8G("ngIf",!i.isBusy)}}let oe=(()=>{var t;class c{constructor(){this.acceptAppointment=new e.bkB,this.declineAppointment=new e.bkB,this.isBusy=!1,this.isUpdatingResponse=!1}get appointment(){return this.request&&this.request.appointments&&this.request.appointments.length>0?this.request.appointments[0]:null}get creatorName(){return this.request&&this.request.creator?`${this.request.creator.firstName} ${this.request.creator.lastName}`:""}get hasResponded(){return"NotResponded"!=this.response}accept(){this.acceptAppointment.emit(),this.isBusy=!0}decline(){this.declineAppointment.emit(),this.isBusy=!0}get response(){return this.request&&this.request.receivers&&this.request.receivers.length>0?this.request.receivers[0].appointmentResponse:"NotResponded"}}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.VBU({type:t,selectors:[["general-appointment-request"]],inputs:{request:"request"},outputs:{acceptAppointment:"acceptAppointment",declineAppointment:"declineAppointment"},decls:4,vars:2,consts:[[4,"ngIf"],[1,"time"],[1,"ion-margin-top"],[3,"innerHtml"],["class","ion-no-padding ion-margin-top",4,"ngIf"],["text-right","",4,"ngIf"],[1,"ion-no-padding","ion-margin-top"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"],["text-right",""],["href","javascript: void(0)",3,"click"],["color","danger",3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],[3,"click",4,"ngIf"],["color","danger",3,"click"],["color","success",3,"click"],[3,"click"]],template:function(n,o){1&n&&(e.j41(0,"ion-card")(1,"ion-card-header"),e.EFF(2),e.k0s(),e.DNE(3,ie,15,19,"ion-card-content",0),e.k0s()),2&n&&(e.R7$(2),e.JRh(o.request.title),e.R7$(),e.Y8G("ngIf",o.appointment))},dependencies:[a.In,a.Jm,a.b_,a.I9,a.ME,a.hU,a.lO,a.ln,s.bT,v.t,C.K,L.k,W.V,f.D9],styles:[".time[_ngcontent-%COMP%]{text-transform:capitalize}.google-file-picker-icon[_ngcontent-%COMP%]{display:inline;width:auto;margin-right:.2em}"]}),c})();function re(t,c){1&t&&(e.j41(0,"div",4),e.nrm(1,"q-spinner"),e.k0s())}function se(t,c){if(1&t){const i=e.RV6();e.j41(0,"general-appointment-request",8),e.bIt("acceptAppointment",function(){e.eBV(i);const o=e.XpG().$implicit,m=e.XpG(2);return e.Njj(m.acceptAppointment(o))})("declineAppointment",function(){e.eBV(i);const o=e.XpG().$implicit,m=e.XpG(2);return e.Njj(m.declineAppointment(o))}),e.k0s()}if(2&t){const i=e.XpG().$implicit;e.Y8G("request",i)}}function ae(t,c){if(1&t){const i=e.RV6();e.j41(0,"parent-teacher-appointment-request",9),e.bIt("pickAppointment",function(o){e.eBV(i);const m=e.XpG().$implicit,E=e.XpG(2);return e.Njj(E.pickAppointment(m,o))})("cancelAppointment",function(o){e.eBV(i);const m=e.XpG().$implicit,E=e.XpG(2);return e.Njj(E.cancelAppointment(m,o))}),e.k0s()}if(2&t){const i=e.XpG().$implicit;e.Y8G("request",i)}}function ce(t,c){if(1&t&&(e.qex(0),e.DNE(1,se,1,1,"general-appointment-request",6)(2,ae,1,1,"parent-teacher-appointment-request",7),e.bVm()),2&t){const i=c.$implicit;e.R7$(),e.Y8G("ngIf","GeneralConference"==i.appointmentType),e.R7$(),e.Y8G("ngIf","ParentTeacherConference"==i.appointmentType)}}function pe(t,c){if(1&t&&(e.qex(0),e.DNE(1,ce,3,2,"ng-container",5),e.bVm()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.appointmentRequests.list)}}const _e=[{path:"",component:(()=>{var t;class c extends _.v{constructor(n,o,m,E,M,y,D){super(n,m,o,E,M,y),this.appointmentRequests=D,this.isInitialized=!1,this.isLoading=!1}ngOnInit(){var n=this;return(0,u.A)(function*(){yield n.appointmentRequests.init(),n.isInitialized=!0})()}refresh(n){var o=this;return(0,u.A)(function*(){o.isLoading=!0,yield o.appointmentRequests.refresh(),o.isLoading=!1,n.target.complete()})()}pickAppointment(n,o){var m=this;return(0,u.A)(function*(){return m.respond(n,o,"Accepted")})()}cancelAppointment(n,o){var m=this;return(0,u.A)(function*(){return m.updateResponse(n,o,"NotResponded")})()}acceptAppointment(n){var o=this;return(0,u.A)(function*(){return o.updateResponse(n,n.appointments[0],"Accepted")})()}declineAppointment(n){var o=this;return(0,u.A)(function*(){return o.updateResponse(n,n.appointments[0],"Declined")})()}respond(n,o,m){var E=this;return(0,u.A)(function*(){let M=n.studentUser?n.receivers.find(D=>D.userId==n.studentUser.userId):n.receivers[0];if(!M){let D=yield(0,A.s)(E.translateService.getTranslation("SAVE_FAILED"));return void E.userAlertService.error(D)}let y={userId:M.userId,appointmentId:o.appointmentId,appointmentRequestId:n.appointmentRequestId,appointmentResponse:m};yield E.appointmentRequests.respond(y),E.appointmentRequests.refresh()})()}updateResponse(n,o,m){var E=this;return(0,u.A)(function*(){let M=n.studentUser?n.receivers.find(D=>D.userId==n.studentUser.userId):n.receivers[0];if(!M){let D=yield(0,A.s)(E.translateService.getTranslation("SAVE_FAILED"));return void E.userAlertService.error(D)}let y={userId:M.userId,appointmentId:o.appointmentId,appointmentRequestId:n.appointmentRequestId,appointmentResponse:m};yield E.appointmentRequests.updateResponse(y),E.appointmentRequests.refresh()})()}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(P.$),e.rXU(a.Xi),e.rXU(R.Ix),e.rXU(f.c$),e.rXU(p.p),e.rXU(g.Z),e.rXU(O))},t.\u0275cmp=e.VBU({type:t,selectors:[["page-appointments"]],features:[e.Vt3],decls:7,vars:5,consts:[[3,"pageTitle"],["slot","fixed",3,"ionRefresh"],["class","ion-padding-top",4,"ngIf"],[4,"ngIf"],[1,"ion-padding-top"],[4,"ngFor","ngForOf"],[3,"request","acceptAppointment","declineAppointment",4,"ngIf"],[3,"request","pickAppointment","cancelAppointment",4,"ngIf"],[3,"acceptAppointment","declineAppointment","request"],[3,"pickAppointment","cancelAppointment","request"]],template:function(n,o){1&n&&(e.nrm(0,"app-header",0),e.nI1(1,"translate"),e.j41(2,"ion-content")(3,"ion-refresher",1),e.bIt("ionRefresh",function(E){return o.refresh(E)}),e.nrm(4,"ion-refresher-content"),e.k0s(),e.DNE(5,re,2,0,"div",2)(6,pe,2,1,"ng-container",3),e.k0s()),2&n&&(e.FS9("pageTitle",e.bMT(1,3,"APPOINTMENTS_TITLE")),e.R7$(5),e.Y8G("ngIf",!o.isInitialized||o.isLoading),e.R7$(),e.Y8G("ngIf",o.isInitialized))},dependencies:[s.Sq,s.bT,a.W9,a.To,a.Ki,B.l,v.t,X,oe,f.D9]}),c})()}];let le=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[R.iI.forChild(_e),R.iI]}),c})();var ue=r(7019),me=r(1683);let de=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[s.MD,l.YN,a.bv,le,ue.h,f.h,me.Y]}),c})()},6090:(N,I,r)=>{r.d(I,{v:()=>P});var s=r(1916),l=r(4438),a=r(1204),R=r(9598),u=r(4742),_=r(230),A=r(5151),e=r(9196);let P=(()=>{var f;class p extends s.${constructor(d,h,T,O,B,v){super(T,O,B),this.account=d,this.router=h,this.userInfoProvider=v}ionViewDidLoad(){}ionViewWillEnter(){}ionViewDidEnter(){}ionViewWillLeave(){}ionViewDidLeave(){}ionViewWillUnload(){}ionViewCanEnter(){return!0}ionViewCanLeave(){return!0}navTo(d,h){const T=Array.isArray(d)?d:[d];this.router.navigate(T,h)}navToUrl(d,h){this.router.navigateByUrl(d,h)}}return(f=p).\u0275fac=function(d){return new(d||f)(l.rXU(a.$),l.rXU(R.Ix),l.rXU(u.Xi),l.rXU(_.c$),l.rXU(A.p),l.rXU(e.Z))},f.\u0275cmp=l.VBU({type:f,selectors:[["ng-component"]],features:[l.Vt3],decls:0,vars:0,template:function(d,h){}}),p})()},8775:(N,I,r)=>{r.d(I,{V:()=>l});var s=r(4438);let l=(()=>{var a;class R{transform(_){return(_=_?_.replace(/href\s*=\s*["']([^"']+)["']/gi,(A,e)=>`href="${e.replace(/\n|<[^>]+>/g,"")}"`):"")?_.replace(/\n/g,"<br/>"):""}}return(a=R).\u0275fac=function(_){return new(_||a)},a.\u0275pipe=s.EJ8({name:"nlHtml",type:a,pure:!0}),R})()},1204:(N,I,r)=>{r.d(I,{$:()=>h});var s=r(467),l=r(4438),a=r(4538),R=r(5320),u=r(9196),_=r(772),A=r(6186),e=r(2840),P=r(3656),f=r(2457),p=r(4840),g=r(7643),d=r(2618);let h=(()=>{var T;class O{constructor(v,U,C,L,G,q,S,x,b,$,k){this.loginSchool=v,this.token=U,this.userInfo=C,this.userSettings=L,this.loginStatus=G,this.roleService=q,this.platform=S,this.push=x,this.rolesProvider=b,this.moduleService=$,this.moduleSettingProvider=k}clearStudentCardPage(){this.studentCardPage&&this.studentCardPage.ngOnDestroy()}logout(){this.token.clearToken(),this.userInfo.clear(),this.rolesProvider.clear(),this.moduleSettingProvider.clear(),this.clearStudentCardPage(),this.loginStatus.setStatus(!1),(this.platform.is("capacitor")||this.platform.is("cordova"))&&this.push.removePushToken()}changeRole(v,U){var C=this;return(0,s.A)(function*(){const L=yield C.roleService.changeRole(v,U);yield C.token.updateToken(L),C.userInfo.refresh();let G=yield C.userInfo.init();C.loginStatus.setRole(G.roleName),C.moduleSettingProvider.updateModuleSettings()})()}logOutAndForgetSchool(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}logOutAndForgetSchoolAndSettings(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}}return(T=O).\u0275fac=function(v){return new(v||T)(l.KVO(a.d),l.KVO(R.x),l.KVO(u.Z),l.KVO(_.w),l.KVO(A.B),l.KVO(e.W),l.KVO(P.OD),l.KVO(f.T),l.KVO(p.L),l.KVO(g.v),l.KVO(d.C))},T.\u0275prov=l.jDH({token:T,factory:T.\u0275fac,providedIn:"root"}),O})()},2129:(N,I,r)=>{r.d(I,{h:()=>a});var s=r(467),l=r(1622);class a extends l.D{constructor(u,_){super(),this.api=u,this.loginStatus=_,this.list=[],this.setupClearOnLogout()}clear(){this.list=[]}init(u){var _=this;return(0,s.A)(function*(){let A=JSON.stringify(u);return A!=_.stringifiedParams&&(_.clear(),_.stringifiedParams=A),_.list.length||(_.list=yield _.loadList(u)),_.list})()}refresh(){var u=this;return(0,s.A)(function*(){return u.list=[],u.init()})()}loadList(u){return this.api.get(this.listEndpoint,u)}setupClearOnLogout(){this.addSub(this.loginStatus.isLoggedInState.subscribe(u=>{u||this.clear()}))}}}}]);