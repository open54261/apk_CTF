"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1096],{4416:(P,I,i)=>{i.d(I,{l:()=>n});var e=i(4438),c=i(9598),r=i(4742),C=i(177),h=i(230);const g=["*"];function _(l,f){if(1&l&&(e.j41(0,"ion-buttons",5),e.nrm(1,"ion-back-button",6),e.nI1(2,"translate"),e.k0s()),2&l){const M=e.XpG();e.R7$(),e.FS9("text",e.bMT(2,2,"BACK")),e.Y8G("defaultHref",M.backPage)}}function p(l,f){1&l&&(e.j41(0,"ion-menu-toggle",5)(1,"ion-button",7),e.nrm(2,"ion-icon",8),e.k0s()())}function m(l,f){if(1&l&&(e.j41(0,"ion-title"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&l){const M=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,1,M.pageTitle)," ")}}let n=(()=>{var l;class f{constructor(v){this.router=v,this.backPage=""}navToMyAccount(){this.router.navigate(["my-account"])}}return(l=f).\u0275fac=function(v){return new(v||l)(e.rXU(c.Ix))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-header"]],inputs:{pageTitle:"pageTitle",backPage:"backPage"},ngContentSelectors:g,decls:9,vars:3,consts:[["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end"],[3,"click"],["name","cog"],["slot","start"],[3,"defaultHref","text"],["size","small","fill","clear"],["name","menu"]],template:function(v,T){1&v&&(e.NAR(),e.j41(0,"ion-header")(1,"ion-toolbar"),e.DNE(2,_,3,4,"ion-buttons",0)(3,p,3,0,"ion-menu-toggle",0)(4,m,3,3,"ion-title",1),e.j41(5,"ion-buttons",2)(6,"ion-button",3),e.bIt("click",function(){return T.navToMyAccount()}),e.nrm(7,"ion-icon",4),e.k0s()()()(),e.SdG(8)),2&v&&(e.R7$(2),e.Y8G("ngIf",T.backPage),e.R7$(),e.Y8G("ngIf",!T.backPage),e.R7$(),e.Y8G("ngIf",!T.isLoadingUserInfo))},dependencies:[r.Jm,r.QW,r.eU,r.iq,r.cA,r.BC,r.ai,r.el,C.bT,h.D9]}),f})()},2952:(P,I,i)=>{i.d(I,{t:()=>h});var e=i(4438),c=i(4742),r=i(177);function C(g,_){if(1&g&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&g){const p=e.XpG();e.R7$(),e.JRh(p.text)}}let h=(()=>{var g;class _{constructor(){this.text=""}}return(g=_).\u0275fac=function(m){return new(m||g)},g.\u0275cmp=e.VBU({type:g,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(m,n){2&m&&e.HbH(n.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(m,n){1&m&&(e.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),e.nrm(3,"ion-spinner"),e.DNE(4,C,2,1,"p",3),e.k0s()()()),2&m&&(e.R7$(4),e.Y8G("ngIf",n.text))},dependencies:[c.hU,c.lO,c.ln,c.w2,r.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),_})()},1096:(P,I,i)=>{i.r(I),i.d(I,{MyAccountPageModule:()=>$});var e=i(177),c=i(9417),r=i(4742),C=i(9598),h=i(467),g=i(5383);const _=new RegExp("^(\\+?\\d{1,3})?[\\s()]*\\d{1,4}[\\s()-]*(\\d[\\s-]*){5,}$");function p(o){return"string"!=typeof o.value?{notAString:o.value}:_.test(o.value)?null:{invalidPhoneNumber:o.value}}var m=i(6090),n=i(4438),l=i(1204),f=i(230),M=i(5151),v=i(9196),T=i(3149),b=i(4416),A=i(2952),O=i(4326),E=i(60);function S(o,u){if(1&o){const a=n.RV6();n.j41(0,"ion-segment",5),n.mxI("ngModelChange",function(s){n.eBV(a);const d=n.XpG();return n.DH7(d.activeView,s)||(d.activeView=s),n.Njj(s)}),n.j41(1,"ion-segment-button",6)(2,"ion-label"),n.EFF(3),n.nI1(4,"translate"),n.k0s()(),n.j41(5,"ion-segment-button",7)(6,"ion-label"),n.EFF(7),n.nI1(8,"translate"),n.k0s()()()}if(2&o){const a=n.XpG();n.R50("ngModel",a.activeView),n.R7$(3),n.SpI(" ",n.bMT(4,3,"ACCOUNT")," "),n.R7$(4),n.SpI(" ",n.bMT(8,5,"CONTACT_DETAILS")," ")}}function F(o,u){1&o&&n.nrm(0,"q-spinner",8)}function R(o,u){if(1&o&&n.nrm(0,"fa-icon",22),2&o){const a=n.XpG(2);n.Y8G("icon",a.faSave)}}function y(o,u){if(1&o&&n.nrm(0,"fa-icon",23),2&o){const a=n.XpG(2);n.Y8G("icon",a.faSpinner)("pulse",!0)("fixedWidth",!0)}}function N(o,u){if(1&o){const a=n.RV6();n.qex(0),n.j41(1,"form",9)(2,"ion-item",10)(3,"ion-label",11),n.EFF(4),n.nI1(5,"translate"),n.k0s(),n.nrm(6,"ion-input",12),n.k0s(),n.j41(7,"validation-error",13),n.EFF(8),n.nI1(9,"translate"),n.k0s(),n.j41(10,"ion-item",10)(11,"ion-label",11),n.EFF(12),n.nI1(13,"translate"),n.k0s(),n.nrm(14,"ion-input",14),n.k0s(),n.j41(15,"validation-error",13),n.EFF(16),n.nI1(17,"translate"),n.k0s(),n.j41(18,"ion-item",10)(19,"ion-label"),n.EFF(20),n.nI1(21,"translate"),n.k0s(),n.nrm(22,"ion-toggle",15),n.k0s(),n.j41(23,"ion-item",10)(24,"ion-label"),n.EFF(25),n.nI1(26,"translate"),n.k0s(),n.nrm(27,"ion-toggle",16),n.k0s()(),n.j41(28,"div",17)(29,"ion-button",18),n.bIt("click",function(){n.eBV(a);const s=n.XpG();return n.Njj(s.saveAll())}),n.DNE(30,R,1,1,"fa-icon",19)(31,y,1,3,"fa-icon",20),n.j41(32,"span"),n.EFF(33),n.nI1(34,"translate"),n.k0s()()(),n.j41(35,"div",21),n.EFF(36),n.nI1(37,"translate"),n.k0s(),n.j41(38,"div",21),n.EFF(39),n.nI1(40,"translate"),n.k0s(),n.bVm()}if(2&o){const a=n.XpG();n.R7$(),n.Y8G("formGroup",a.settingsForm),n.R7$(3),n.JRh(n.bMT(5,17,"EMAIL")),n.R7$(3),n.Y8G("enabled",a.emailValidationEnabled)("valid",a.isEmailValid),n.R7$(),n.SpI(" ",n.bMT(9,19,"VALIDATION_FAILED_FOR_EMAIL")," "),n.R7$(4),n.JRh(n.bMT(13,21,"MOBILE")),n.R7$(3),n.Y8G("enabled",a.phoneNumberValidationEnabled)("valid",a.isPhoneNumberValid),n.R7$(),n.SpI(" ",n.bMT(17,23,"VALIDATION_FAILED_FOR_PHONENUMBER")," "),n.R7$(4),n.SpI("",n.bMT(21,25,"SHARE_MY_CONTACT_DETAILS")," *"),n.R7$(5),n.SpI("",n.bMT(26,27,"EMAIL_NOTICES")," **"),n.R7$(4),n.Y8G("disabled",!a.hasChanges||a.hasInvalidChanges),n.R7$(),n.Y8G("ngIf",!a.isSaving),n.R7$(),n.Y8G("ngIf",a.isSaving),n.R7$(2),n.SpI("\xa0",n.bMT(34,29,"SAVE"),""),n.R7$(3),n.SpI(" * ",n.bMT(37,31,"SHARE_MY_CONTACT_DETAILS_EXPLANATION")," "),n.R7$(3),n.SpI(" ** ",n.bMT(40,33,"EMAIL_NOTICES_EXPLANATION")," ")}}function x(o,u){if(1&o){const a=n.RV6();n.j41(0,"div")(1,"ion-button",24),n.bIt("click",function(){n.eBV(a);const s=n.XpG();return n.Njj(s.navTo("tutorial"))}),n.EFF(2),n.nI1(3,"translate"),n.k0s(),n.j41(4,"ion-button",24),n.bIt("click",function(){n.eBV(a);const s=n.XpG();return n.Njj(s.logout())}),n.EFF(5),n.nI1(6,"translate"),n.k0s()()}2&o&&(n.R7$(2),n.SpI(" ",n.bMT(3,2,"SHOW_INTRO_AGAIN")," "),n.R7$(3),n.SpI(" ",n.bMT(6,4,"LOGOUT")," "))}const G=[{path:"",component:(()=>{var o;class u extends m.v{constructor(t,s,d,D,U,k,L){super(t,d,s,D,U,k),this.preferencesService=L,this.isInitialized=!1,this.isSaving=!1,this.isSavingContacts=!1,this.isSavingOptions=!1,this.activeView="account",this.userInfo={},this.faSave=g.hSh,this.faSpinner=g.z1G}ngOnInit(){this.initView(),this.addSub(this.userInfoProvider.userInfoState.subscribe(t=>this.userInfo=t))}get hasChanges(){return this.isEmailChanged||this.isPhoneNumberChanged||this.isShowContactInformationChanged||this.isRedirectMessagesToMailChanged}get userFullName(){return this.userInfo&&this.userInfo.userFullName||""}get isEmailChanged(){return this.userContact&&this.settingsForm.controls.email.value!=this.userContact.email}get isPhoneNumberChanged(){return this.userContact&&this.settingsForm.controls.phoneNumber.value!=this.userContact.phoneNumber}get isShowContactInformationChanged(){return this.userContact&&this.settingsForm.controls.showContactInformation.value!=this.userContact.showContactInformation}get isRedirectMessagesToMailChanged(){return this.userOptions&&this.settingsForm.controls.redirectMessageToMail.value!=this.userOptions.redirectMessageToMail}get hasInvalidChanges(){return this.isEmailChanged&&!this.isEmailValid||this.isPhoneNumberChanged&&!this.isPhoneNumberValid}get isEmailValid(){return""==this.settingsForm.controls.email.value||this.settingsForm.controls.email.valid}get isPhoneNumberValid(){return""==this.settingsForm.controls.phoneNumber.value||this.settingsForm.controls.phoneNumber.valid}get emailValidationEnabled(){return this.isEmailChanged}get phoneNumberValidationEnabled(){return this.isPhoneNumberChanged}saveAll(){var t=this;return(0,h.A)(function*(){t.isSaving=!0,yield Promise.all([t.saveContact(),t.saveOptions()]);let s=yield t.translate("SAVE_COMPLETE","Sparat");t.isSaving=!1,t.userAlertService.info(s)})()}saveContact(){var t=this;return(0,h.A)(function*(){t.isSavingContacts=!0;let s=Object.assign({},t.userContact,{email:t.settingsForm.controls.email.value,phoneNumber:t.settingsForm.controls.phoneNumber.value,showContactInformation:t.settingsForm.controls.showContactInformation.value});try{yield t.preferencesService.updateUserContact(s)}catch(d){throw d}finally{t.isSavingContacts=!1}t.userContact.email=t.settingsForm.controls.email.value,t.userContact.phoneNumber=t.settingsForm.controls.phoneNumber.value,t.userContact.showContactInformation=t.settingsForm.controls.showContactInformation.value})()}saveOptions(){var t=this;return(0,h.A)(function*(){t.isSavingOptions=!0;let s=Object.assign({},t.userOptions,{redirectMessageToMail:t.settingsForm.controls.redirectMessageToMail.value});try{yield t.preferencesService.updateUserOptions(s)}catch(d){throw d}finally{t.isSavingContacts=!1}t.userOptions.redirectMessageToMail=t.settingsForm.controls.redirectMessageToMail.value})()}logout(){this.account.logOutAndForgetSchool(),window.location.reload()}buildForm(){return new c.gE({email:new c.MJ(this.userContact.email,[c.k0.email]),phoneNumber:new c.MJ(this.userContact.phoneNumber,[p]),showContactInformation:new c.MJ(this.userContact.showContactInformation),redirectMessageToMail:new c.MJ(this.userOptions.redirectMessageToMail)})}initView(){var t=this;return(0,h.A)(function*(){yield t.loadSettings(),yield t.userInfoProvider.init(),t.settingsForm=t.buildForm(),t.isInitialized=!0})()}loadSettings(){var t=this;return(0,h.A)(function*(){let[s,d]=yield Promise.all([t.preferencesService.getUserContact(),t.preferencesService.getUserOptions()]);t.userContact=s,t.userOptions=d})()}}return(o=u).\u0275fac=function(t){return new(t||o)(n.rXU(l.$),n.rXU(r.Xi),n.rXU(C.Ix),n.rXU(f.c$),n.rXU(M.p),n.rXU(v.Z),n.rXU(T.W))},o.\u0275cmp=n.VBU({type:o,selectors:[["app-my-account"]],features:[n.Vt3],decls:7,vars:7,consts:[[3,"pageTitle"],[1,"ion-padding"],["color","action",3,"ngModel","ngModelChange",4,"ngIf"],["class","ion-margin-top",4,"ngIf"],[4,"ngIf"],["color","action",3,"ngModelChange","ngModel"],["value","account"],["value","contact"],[1,"ion-margin-top"],["novalidate","",3,"formGroup"],[1,"ion-no-padding"],["position","stacked"],["formControlName","email","type","email","required",""],[3,"enabled","valid"],["formControlName","phoneNumber"],["color","action","formControlName","showContactInformation"],["color","action","formControlName","redirectMessageToMail"],[1,"ion-text-center","ion-margin-vertical"],["color","success",3,"click","disabled"],[3,"icon",4,"ngIf"],["size","lg",3,"icon","pulse","fixedWidth",4,"ngIf"],[1,"asterisk"],[3,"icon"],["size","lg",3,"icon","pulse","fixedWidth"],["size","large","fill","outline","expand","block",3,"click"]],template:function(t,s){1&t&&(n.nrm(0,"app-header",0),n.nI1(1,"translate"),n.j41(2,"ion-content",1),n.DNE(3,S,9,7,"ion-segment",2)(4,F,1,0,"q-spinner",3)(5,N,41,35,"ng-container",4)(6,x,7,6,"div",4),n.k0s()),2&t&&(n.FS9("pageTitle",n.bMT(1,5,"MY_ACCOUNT_TITLE")),n.R7$(3),n.Y8G("ngIf",s.isInitialized),n.R7$(),n.Y8G("ngIf",!s.isInitialized&&"contact"===s.activeView),n.R7$(),n.Y8G("ngIf",s.isInitialized&&"contact"===s.activeView),n.R7$(),n.Y8G("ngIf","account"===s.activeView))},dependencies:[e.bT,c.qT,c.BC,c.cb,c.YS,c.vS,r.Jm,r.W9,r.$w,r.uz,r.he,r.Gp,r.eP,r.BY,r.hB,r.Je,r.Gw,b.l,A.t,O.v,c.j4,c.JD,E.aY,f.D9],styles:["ion-header[_ngcontent-%COMP%]   ion-navbar[_ngcontent-%COMP%]   ion-title.header-title[_ngcontent-%COMP%]{padding-right:0}ion-header[_ngcontent-%COMP%]   ion-navbar[_ngcontent-%COMP%]   ion-title.header-title[_ngcontent-%COMP%]   .toolbar-title[_ngcontent-%COMP%]{text-align:left}.asterisk[_ngcontent-%COMP%]{font-size:.8em;font-style:italic}.asterisk[_ngcontent-%COMP%]:not(:last-child){margin-bottom:.5em}"]}),u})()}];let j=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[C.iI.forChild(G),C.iI]}),u})();var V=i(7019);let $=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[e.MD,c.YN,r.bv,j,V.h,f.h,c.X1,E.dX]}),u})()}}]);