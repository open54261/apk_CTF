"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4360],{1916:(x,D,i)=>{i.d(D,{$:()=>b});var o=i(467),_=i(3207),t=i(4438),m=i(4742),d=i(230),g=i(5151);let b=(()=>{var T;class e{constructor(l,E,p){this.loadingCtrl=l,this.translateService=E,this.userAlertService=p,this.subscriptions=[],this.showLoading=!1,this.loadingDismissTimeout=-1,this.loadingDismissTimeoutMS=3e4}ngOnDestroy(){this.subscriptions.forEach(l=>l.unsubscribe())}addSub(l){this.subscriptions.push(l)}translate(l,E){var p=this;return(0,o.A)(function*(){return(yield(0,_.s)(p.translateService.get(l)))||E||l})()}withSpinner(l,E,p){var P=this;return(0,o.A)(function*(){let S;yield P.presentLoading(E),P.loadingDismissTimeout=setTimeout(()=>P.timeoutLoading(p),P.loadingDismissTimeoutMS);try{S=yield l()}catch(A){P.userAlertService.debug(A)}return yield P.dismissLoading(),S})()}timeoutLoading(l){var E=this;return(0,o.A)(function*(){l||(l=yield E.translate("LOADING_FAILED")),E.userAlertService.error(l),yield E.dismissLoading()})()}dismissLoading(){var l=this;return(0,o.A)(function*(){-1!=l.loadingDismissTimeout&&(clearTimeout(l.loadingDismissTimeout),l.loadingDismissTimeout=-1),l.showLoading=!1,(yield l.loadingCtrl.getTop())&&(yield l.loadingCtrl.dismiss(null))})()}presentLoading(l){var E=this;return(0,o.A)(function*(){return E.showLoading=!0,yield E.loadingCtrl.create({message:l}).then(p=>{p.present().then(()=>{E.showLoading&&p.dismiss()})})})()}}return(T=e).\u0275fac=function(l){return new(l||T)(t.rXU(m.Xi),t.rXU(d.c$),t.rXU(g.p))},T.\u0275cmp=t.VBU({type:T,selectors:[["ng-component"]],decls:0,vars:0,template:function(l,E){},encapsulation:2}),e})()},4416:(x,D,i)=>{i.d(D,{l:()=>M});var o=i(4438),_=i(9598),t=i(4742),m=i(177),d=i(230);const g=["*"];function b(l,E){if(1&l&&(o.j41(0,"ion-buttons",5),o.nrm(1,"ion-back-button",6),o.nI1(2,"translate"),o.k0s()),2&l){const p=o.XpG();o.R7$(),o.FS9("text",o.bMT(2,2,"BACK")),o.Y8G("defaultHref",p.backPage)}}function T(l,E){1&l&&(o.j41(0,"ion-menu-toggle",5)(1,"ion-button",7),o.nrm(2,"ion-icon",8),o.k0s()())}function e(l,E){if(1&l&&(o.j41(0,"ion-title"),o.EFF(1),o.nI1(2,"translate"),o.k0s()),2&l){const p=o.XpG();o.R7$(),o.SpI(" ",o.bMT(2,1,p.pageTitle)," ")}}let M=(()=>{var l;class E{constructor(P){this.router=P,this.backPage=""}navToMyAccount(){this.router.navigate(["my-account"])}}return(l=E).\u0275fac=function(P){return new(P||l)(o.rXU(_.Ix))},l.\u0275cmp=o.VBU({type:l,selectors:[["app-header"]],inputs:{pageTitle:"pageTitle",backPage:"backPage"},ngContentSelectors:g,decls:9,vars:3,consts:[["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end"],[3,"click"],["name","cog"],["slot","start"],[3,"defaultHref","text"],["size","small","fill","clear"],["name","menu"]],template:function(P,S){1&P&&(o.NAR(),o.j41(0,"ion-header")(1,"ion-toolbar"),o.DNE(2,b,3,4,"ion-buttons",0)(3,T,3,0,"ion-menu-toggle",0)(4,e,3,3,"ion-title",1),o.j41(5,"ion-buttons",2)(6,"ion-button",3),o.bIt("click",function(){return S.navToMyAccount()}),o.nrm(7,"ion-icon",4),o.k0s()()()(),o.SdG(8)),2&P&&(o.R7$(2),o.Y8G("ngIf",S.backPage),o.R7$(),o.Y8G("ngIf",!S.backPage),o.R7$(),o.Y8G("ngIf",!S.isLoadingUserInfo))},dependencies:[t.Jm,t.QW,t.eU,t.iq,t.cA,t.BC,t.ai,t.el,m.bT,d.D9]}),E})()},2952:(x,D,i)=>{i.d(D,{t:()=>d});var o=i(4438),_=i(4742),t=i(177);function m(g,b){if(1&g&&(o.j41(0,"p"),o.EFF(1),o.k0s()),2&g){const T=o.XpG();o.R7$(),o.JRh(T.text)}}let d=(()=>{var g;class b{constructor(){this.text=""}}return(g=b).\u0275fac=function(e){return new(e||g)},g.\u0275cmp=o.VBU({type:g,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(e,M){2&e&&o.HbH(M.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(e,M){1&e&&(o.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),o.nrm(3,"ion-spinner"),o.DNE(4,m,2,1,"p",3),o.k0s()()()),2&e&&(o.R7$(4),o.Y8G("ngIf",M.text))},dependencies:[_.hU,_.lO,_.ln,_.w2,t.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),b})()},1876:(x,D,i)=>{i.d(D,{Y:()=>o});class o{constructor(t){this._selectedItems=[],this.equalityFunction=(m,d)=>m==d,t&&(this.equalityFunction=t)}get isAnySelected(){return this._selectedItems.length>0}get selectedItems(){return this._selectedItems}isSelected(t){return!!this.selectedItems.find(d=>this.equalityFunction(t,d))}clear(){this._selectedItems=[]}deselectItem(t){let d=this.selectedItems.findIndex(g=>this.equalityFunction(t,g));d>-1&&this.selectedItems.splice(d,1)}selectItem(t){this.isSelected(t)||this.selectedItems.push(t)}selectItems(t){t.forEach(m=>this.selectItem(m))}setSelectedItems(t){this._selectedItems=t}toggleItem(t){this.isSelected(t)?this.deselectItem(t):this.selectItem(t)}}},1979:(x,D,i)=>{i.r(D),i.d(D,{AbsenceRequestPageModule:()=>ee});var o=i(177),_=i(9417),t=i(4742),m=i(9598),d=i(467),g=i(3207),b=i(6090),T=i(8330),e=i(4438),M=i(1204),l=i(230),E=i(5151),p=i(9196),P=i(6244);let S=(()=>{var a;class v{constructor(n){this.api=n,this.getAbsenceRequestUrl="api/"}getAbsenceRequestTypes(){return this.api.get(this.getAbsenceRequestUrl+"attendancetypes?canBeRequested=true")}CreateAbsenceRequest(n){return this.api.postFormData(`${this.getAbsenceRequestUrl}absencerequests`,n)}getAbsenceRequests(n){return this.api.get(`${this.getAbsenceRequestUrl}students/${n}/absencerequests`)}withdrawAbsenceRequests(n){return this.api.post(`${this.getAbsenceRequestUrl}absencerequests/${n}/withdraw`)}}return(a=v).\u0275fac=function(n){return new(n||a)(e.KVO(P.j))},a.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),v})();var A=i(8593),B=i(6969),u=i(4416),C=i(2952);const h=["modal"],f=a=>({disabled:a});function R(a,v){if(1&a&&(e.j41(0,"ion-label",11),e.EFF(1),e.k0s()),2&a){const r=e.XpG(2);e.R7$(),e.SpI(" ",null==r.selectedStudent?null:r.selectedStudent.schoolName," ")}}function O(a,v){if(1&a){const r=e.RV6();e.j41(0,"ion-toolbar")(1,"ion-item",6)(2,"h5",7),e.EFF(3),e.k0s()(),e.j41(4,"ion-item",8),e.bIt("click",function(){e.eBV(r);const s=e.XpG();return e.Njj(s.onClickStudent())}),e.j41(5,"ion-label",9),e.EFF(6),e.nI1(7,"translate"),e.DNE(8,R,2,1,"ion-label",10),e.k0s()()()}if(2&a){const r=e.XpG();e.R7$(3),e.JRh(null==r.userInfo?null:r.userInfo.schoolName),e.R7$(3),e.SpI(" ",(null==r.selectedStudent?null:r.selectedStudent.name)||e.bMT(7,3,"SELECT_STUDENT")," "),e.R7$(2),e.Y8G("ngIf",r.selectedStudent)}}function L(a,v){if(1&a){const r=e.RV6();e.j41(0,"div",12)(1,"ion-segment",13),e.mxI("ngModelChange",function(s){e.eBV(r);const c=e.XpG();return e.DH7(c.listType,s)||(c.listType=s),e.Njj(s)}),e.j41(2,"ion-segment-button",14),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"ion-segment-button",15),e.EFF(6),e.nI1(7,"translate"),e.k0s()()()}if(2&a){const r=e.XpG();e.R7$(),e.R50("ngModel",r.listType),e.R7$(2),e.SpI(" ",e.bMT(4,3,"NEW_REGUESTS")," "),e.R7$(3),e.SpI(" ",e.bMT(7,5,"REGUESTS")," ")}}function F(a,v){1&a&&(e.j41(0,"div"),e.nrm(1,"q-spinner"),e.k0s())}function G(a,v){if(1&a){const r=e.RV6();e.j41(0,"ion-datetime",26),e.mxI("ngModelChange",function(s){e.eBV(r);const c=e.XpG(4);return e.DH7(c.attendanceEntry.startDate,s)||(c.attendanceEntry.startDate=s),e.Njj(s)}),e.k0s(),e.j41(1,"ion-button",27),e.bIt("click",function(){e.eBV(r),e.XpG();const s=e.sdS(13);return e.Njj(s.dismiss())}),e.EFF(2,"V\xe4lj"),e.k0s()}if(2&a){const r=e.XpG(4);e.R50("ngModel",r.attendanceEntry.startDate)}}function $(a,v){if(1&a){const r=e.RV6();e.j41(0,"ion-datetime",28),e.mxI("ngModelChange",function(s){e.eBV(r);const c=e.XpG(4);return e.DH7(c.attendanceEntry.endDate,s)||(c.attendanceEntry.endDate=s),e.Njj(s)}),e.k0s(),e.j41(1,"ion-button",27),e.bIt("click",function(){e.eBV(r),e.XpG();const s=e.sdS(21);return e.Njj(s.dismiss())}),e.EFF(2,"V\xe4lj"),e.k0s()}if(2&a){const r=e.XpG(4);e.R50("ngModel",r.attendanceEntry.endDate)}}function k(a,v){if(1&a&&(e.j41(0,"ion-select-option",31),e.EFF(1),e.k0s()),2&a){const r=v.$implicit;e.Y8G("value",r.attendanceTypeId),e.R7$(),e.JRh(r.name)}}function V(a,v){if(1&a){const r=e.RV6();e.j41(0,"ion-col",18)(1,"ion-select",29),e.mxI("ngModelChange",function(s){e.eBV(r);const c=e.XpG(4);return e.DH7(c.selectedAttendanceType,s)||(c.selectedAttendanceType=s),e.Njj(s)}),e.DNE(2,k,2,2,"ion-select-option",30),e.k0s()()}if(2&a){const r=e.XpG(4);e.R7$(),e.R50("ngModel",r.selectedAttendanceType),e.R7$(),e.Y8G("ngForOf",r.attendanceType)}}function N(a,v){if(1&a){const r=e.RV6();e.qex(0),e.j41(1,"div",12)(2,"ion-row")(3,"ion-col",16)(4,"ion-label",17),e.EFF(5),e.nI1(6,"translate"),e.k0s()(),e.j41(7,"ion-col",18)(8,"p",19),e.EFF(9,"Fr\xe5n"),e.k0s()(),e.j41(10,"ion-col",18),e.nrm(11,"ion-datetime-button",20),e.j41(12,"ion-modal",21,0),e.DNE(14,G,3,1,"ng-template"),e.k0s()(),e.j41(15,"ion-col",18)(16,"p",19),e.EFF(17,"Till"),e.k0s()(),e.j41(18,"ion-col",18),e.nrm(19,"ion-datetime-button",22),e.j41(20,"ion-modal",21,1),e.DNE(22,$,3,1,"ng-template"),e.k0s()()(),e.nrm(23,"br")(24,"ion-row"),e.j41(25,"ion-row")(26,"ion-col",18)(27,"p",19),e.EFF(28,"Ange sk\xe4l till ledighet:"),e.k0s(),e.j41(29,"div")(30,"ion-input",23),e.mxI("ngModelChange",function(s){e.eBV(r);const c=e.XpG(3);return e.DH7(c.attendanceEntry.message,s)||(c.attendanceEntry.message=s),e.Njj(s)}),e.k0s()()(),e.DNE(31,V,3,2,"ion-col",24),e.k0s(),e.nrm(32,"br"),e.j41(33,"ion-button",25),e.bIt("click",function(){e.eBV(r);const s=e.XpG(3);return e.Njj(s.submit())}),e.EFF(34),e.nI1(35,"translate"),e.k0s()(),e.bVm()}if(2&a){const r=e.XpG(3);e.R7$(5),e.JRh(e.bMT(6,9,"ABOUT_REGUESTS")),e.R7$(7),e.Y8G("keepContentsMounted",!0)("canDismiss",!0),e.R7$(8),e.Y8G("keepContentsMounted",!0)("canDismiss",!0),e.R7$(10),e.R50("ngModel",r.attendanceEntry.message),e.R7$(),e.Y8G("ngIf",r.attendanceType.length>1),e.R7$(2),e.Y8G("disabled",r.onSubmit),e.R7$(),e.JRh(e.bMT(35,11,"ABOUT_REGUESTS"))}}function K(a,v){if(1&a){const r=e.RV6();e.j41(0,"div")(1,"ion-button",40),e.bIt("click",function(){e.eBV(r);const s=e.XpG().$implicit,c=e.XpG(5);return e.Njj(c.delete(s))}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}2&a&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"DELETE_REQUESTS")," "))}function X(a,v){if(1&a&&(e.j41(0,"ion-row")(1,"ion-col")(2,"div",34)(3,"ion-row",35)(4,"ion-col")(5,"h1"),e.nrm(6,"ion-icon",36),e.k0s()(),e.j41(7,"ion-col",37)(8,"p",38),e.EFF(9),e.k0s(),e.j41(10,"p"),e.EFF(11),e.k0s()(),e.j41(12,"ion-col",39),e.DNE(13,K,4,3,"div",4),e.k0s()()()()()),2&a){const r=v.$implicit,n=e.XpG(5);e.R7$(2),e.Y8G("ngClass",e.eq3(7,f,!r.confirmed&&!r.accepted&&!n.isStartDateAfterToday(r.startDate))),e.R7$(4),e.Y8G("name",n.getIconName(r))("color",n.getIconColor(r)),e.R7$(3),e.SpI(" ",n.getAbsenceRequestMessage(r),""),e.R7$(2),e.Lme("F\xf6rfr\xe5gan gjordes av ",r.senderName," g\xe4llande ",r.student.firstName,""),e.R7$(2),e.Y8G("ngIf",!r.confirmed&&!r.accepted&&n.isStartDateAfterToday(r.startDate))}}function W(a,v){if(1&a&&(e.qex(0),e.DNE(1,X,14,9,"ion-row",33),e.bVm()),2&a){const r=e.XpG(4);e.R7$(),e.Y8G("ngForOf",r.absenceRequest)}}function w(a,v){1&a&&(e.j41(0,"ion-label")(1,"h4",41),e.EFF(2,"Inga ledighetsans\xf6kningar"),e.k0s()())}function q(a,v){if(1&a&&(e.qex(0),e.j41(1,"ion-list"),e.DNE(2,W,2,1,"ng-container",32)(3,w,3,0,"ng-template",null,2,e.C5r),e.k0s(),e.bVm()),2&a){const r=e.sdS(4),n=e.XpG(3);e.R7$(2),e.Y8G("ngIf",n.absenceRequest.length>0)("ngIfElse",r)}}function Y(a,v){if(1&a&&(e.j41(0,"div"),e.DNE(1,N,36,13,"ng-container",4)(2,q,5,2,"ng-container",4),e.k0s()),2&a){const r=e.XpG(2);e.R7$(),e.Y8G("ngIf","newRequest"==r.listType),e.R7$(),e.Y8G("ngIf","prevRequest"==r.listType)}}function H(a,v){if(1&a&&(e.qex(0),e.DNE(1,Y,3,2,"div",4),e.bVm()),2&a){const r=e.XpG();e.R7$(),e.Y8G("ngIf",r.selectedStudent)}}const z=[{path:"",component:(()=>{var a;class v extends b.v{constructor(n,s,c,I,y,j,U,te,ne,ie,se,oe,ae){super(n,s,c,I,y,j),this.modalCtrl=U,this.absenceRequestService=te,this.studentService=ne,this.students=ie,this.toastCtrl=se,this.modalController=oe,this.alertController=ae,this.selectedDate=new Date,this.isBusy=!1,this.onSubmit=!1,this.userInfo={},this.classStudents=[],this.teachers=[],this.listType="newRequest",this.filteredClassStudents=[],this.filteredTeachers=[],this.absenceRequest=[],this.attendanceEntry={},this.attendanceType=[],this.filteredStudents=[],this.initLang()}isGuardian(){return this.userInfo&&"Guardian"==this.userInfo.roleName}validateAndShowError(n){return this.showToast(n,"danger"),this.onSubmit=!1,this.isBusy=!1,!1}submit(){var n=this;return(0,d.A)(function*(){if(n.onSubmit=!0,n.isBusy=!0,!n.validateForm())return;const s=new Date(n.attendanceEntry.startDate),c=new Date(n.attendanceEntry.endDate);if(c<s)return void n.validateAndShowError("Slutdatum kan inte vara tidigare \xe4n startdatum");const I=new Date;if(s<I||c<I)return void n.validateAndShowError("Du kan inte v\xe4lja ett datum bak\xe5t i tiden");const y=n.extractTimeFromDate(s),j=n.extractTimeFromDate(c);n.attendanceEntry.startTime=y,n.attendanceEntry.endTime=j,n.attendanceEntry.studentId=parseInt(n.selectedStudent.id),n.attendanceEntry.attendanceTypeId=n.selectedAttendanceType||n.attendanceType[0].attendanceTypeId;try{yield n.absenceRequestService.CreateAbsenceRequest(n.attendanceEntry),n.attendanceEntry={},n.showToast("Ledighetsans\xf6kan skickad","success"),n.initView(n.selectedStudent.id)}catch(U){n.showToast("Ett fel intr\xe4ffade","danger")}finally{n.onSubmit=!1,n.isBusy=!1}})()}validateForm(){var n;return null!==(n=this.selectedStudent)&&void 0!==n&&n.id?this.attendanceEntry.startDate?this.attendanceEntry.endDate?!!this.attendanceEntry.message||(this.validateAndShowError("Skriv ett meddelande"),!1):(this.validateAndShowError("V\xe4lj slutdatum"),!1):(this.validateAndShowError("V\xe4lj startdatum"),!1):(this.validateAndShowError("V\xe4lj elev"),!1)}extractTimeFromDate(n){return`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}delete(n){var s=this;return(0,d.A)(function*(){var I;console.log("delete",n),yield(yield s.alertController.create({header:"\xc5terta",subHeader:"Vill du \xe5terta denna ledighetsans\xf6kan?",buttons:[{text:"Avbryt",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Filter Cancelled")}},{text:"\xc5terta",handler:(I=(0,d.A)(function*(){try{yield s.absenceRequestService.withdrawAbsenceRequests(n.absenceRequestId),s.initView(s.selectedStudent.id)}catch(y){s.showToast("Ett fel intr\xe4ffade","danger")}}),function(){return I.apply(this,arguments)})}]})).present()})()}showToast(n,s){var c=this;return(0,d.A)(function*(){yield(yield c.toastCtrl.create({message:n,duration:3500,position:"top",color:s})).present()})()}closeModal(){this.modalController.dismiss()}ngOnInit(){var n=this;return(0,d.A)(function*(){n.isBusy=!0,n.addSub(n.userInfoProvider.userInfoState.subscribe(I=>n.userInfo=I));var c=(yield n.studentService.getStudents()).filter(I=>I.schoolId===n.userInfo.schoolId);n.filteredStudents=c.map(I=>({id:I.studentId.toString(),name:`${I.firstName} ${I.lastName}`,schoolName:I.schoolName})),yield n.students.init(),n.initSelection(),n.isBusy=!1})()}onClickStudent(){var n=this;return(0,d.A)(function*(){console.log(n.filteredStudents);let s=yield n.modalCtrl.create({component:T.M,componentProps:{items:n.filteredStudents}});s.present(),s.onDidDismiss().then(c=>{c&&c.data&&c.data.item&&(!n.selectedStudent||c.data.item.id!=n.selectedStudent.id)&&n.selectStudent(c.data.item)})})()}navToMyAccount(){this.navTo("my-account")}initLang(){var n=this;return(0,d.A)(function*(){n.translations=yield(0,g.s)(n.translateService.get(["SEARCH","SEARCH_BY_NAME_OR_SUBJECT"]))})()}initSelection(){1==this.students.list.length&&this.selectStudent(this.students.list[0])}initView(n){var s=this;return(0,d.A)(function*(){if(s.isBusy=!0,s.absenceRequest=[],s.attendanceType=[],n){let[c,I]=yield Promise.all([s.loadRequests(n),s.loadRequestTypes()]);s.absenceRequest=c,s.attendanceType=I}else s.absenceRequest=[],s.attendanceType=[];s.isBusy=!1})()}loadRequests(n){var s=this;return(0,d.A)(function*(){return yield s.absenceRequestService.getAbsenceRequests(n)})()}loadRequestTypes(){var n=this;return(0,d.A)(function*(){return yield n.absenceRequestService.getAbsenceRequestTypes()})()}selectStudent(n){this.selectedStudent=n,this.initView(this.selectedStudent.id)}getAbsenceRequestMessage(n){const s=new Date(n.startDate),c=`${s.getFullYear()}/${s.getMonth()+1}/${s.getDate()}`,I=n.startTime?n.startTime.split(":").slice(0,2).join(":"):"",y=new Date(n.endDate),j=`${y.getFullYear()}/${y.getMonth()+1}/${y.getDate()}`,U=n.endTime?n.endTime.split(":").slice(0,2).join(":"):"";return n.withdrawn?`${c} ${I} - ${j} ${U} (\xc5tertagen)`:n.confirmed&&n.accepted?`${c} ${I} - ${j} ${U} (Beviljad)`:n.confirmed||n.accepted?n.confirmed&&!n.accepted?`${c} ${I} - ${j} ${U} (Ej Beviljad)`:"":`${c} ${I} - ${j} ${U} (Obekr\xe4ftad)`}getIconName(n){return n.withdrawn?"close-outline":n.confirmed&&n.accepted?"checkmark-outline":n.confirmed||n.accepted?n.confirmed&&!n.accepted?"close-outline":"":"help-outline"}getIconColor(n){return n.withdrawn?"danger":n.confirmed&&n.accepted?"success":n.confirmed||n.accepted?n.confirmed&&!n.accepted?"danger":"":"warning"}isStartDateAfterToday(n){const s=new Date;s.setHours(0,0,0,0);const c=new Date(n);return c.setHours(0,0,0,0),c>s}}return(a=v).\u0275fac=function(n){return new(n||a)(e.rXU(M.$),e.rXU(m.Ix),e.rXU(t.Xi),e.rXU(l.c$),e.rXU(E.p),e.rXU(p.Z),e.rXU(t.W3),e.rXU(S),e.rXU(A.b),e.rXU(B.s),e.rXU(t.K_),e.rXU(t.W3),e.rXU(t.hG))},a.\u0275cmp=e.VBU({type:a,selectors:[["page-absence-request"]],viewQuery:function(n,s){if(1&n&&e.GBs(h,5),2&n){let c;e.mGM(c=e.lsd())&&(s.modal=c.first)}},features:[e.Vt3],decls:7,vars:7,consts:[["modal2",""],["modal",""],["noRequests",""],[3,"pageTitle"],[4,"ngIf"],["class","ion-padding",4,"ngIf"],["lines","none",1,"select-student"],[1,"studentname"],["button","","lines","none",1,"select-student",3,"click"],[1,"listItem"],["class","light-label",4,"ngIf"],[1,"light-label"],[1,"ion-padding"],["color","action",3,"ngModelChange","ngModel"],["value","newRequest"],["value","prevRequest"],["size","12",1,"info"],[1,"info"],["size","12"],[1,"text"],["datetime","datetime",2,"float","left"],[3,"keepContentsMounted","canDismiss"],["datetime","datetime2",2,"float","left"],["type","text","placeholder","",1,"input-field",3,"ngModelChange","ngModel"],["size","12",4,"ngIf"],["fill","outline","expand","block",3,"click","disabled"],["min","2022","max","2030","id","datetime",3,"ngModelChange","ngModel"],["size","small",1,"margin",3,"click"],["min","2022","max","2030","id","datetime2",3,"ngModelChange","ngModel"],["placeholder","V\xe4lj typ av ledighet",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"btm-border"],["slot","start","size","large",2,"margin-left","10px","margin-top","-10px",3,"name","color"],["size","8"],[2,"font-size","x-small","font-weight","bold"],["size","2"],["color","warning",1,"delete-button",3,"click"],[2,"text-align","center"]],template:function(n,s){1&n&&(e.j41(0,"app-header",3),e.nI1(1,"translate"),e.DNE(2,O,9,5,"ion-toolbar",4),e.k0s(),e.j41(3,"ion-content"),e.DNE(4,L,8,7,"div",5)(5,F,2,0,"div",4)(6,H,2,1,"ng-container",4),e.k0s()),2&n&&(e.FS9("pageTitle",e.bMT(1,5,"SEMSETER_APPLICATION")),e.R7$(2),e.Y8G("ngIf",s.isGuardian),e.R7$(2),e.Y8G("ngIf",s.selectedStudent),e.R7$(),e.Y8G("ngIf",s.isBusy),e.R7$(),e.Y8G("ngIf",null==s.selectedStudent?null:s.selectedStudent.name))},dependencies:[o.YU,o.Sq,o.bT,_.BC,_.vS,t.Jm,t.hU,t.W9,t.A9,t.K4,t.iq,t.$w,t.uz,t.he,t.nf,t.ln,t.Gp,t.eP,t.Nm,t.Ip,t.ai,t.Sb,t.Je,t.Gw,u.l,C.t,l.D9],styles:[".userinfo[_ngcontent-%COMP%]{text-align:center;font:1em sans-serif;padding:300px}.confirmed[_ngcontent-%COMP%]{background-color:green}.not-confirmed[_ngcontent-%COMP%]{background-color:#ff0}ion-label[_ngcontent-%COMP%]{font-weight:700;font-size:small}h6[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-weight:700;font-size:small}p[_ngcontent-%COMP%]{font-size:x-small}ion-input[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%]{display:block;width:100%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.delete-button[_ngcontent-%COMP%]{font-size:10px;height:25px;margin-left:-10px}.studentname[_ngcontent-%COMP%]{text-align:left;font-size:18px;font-weight:600;color:#303940}.listItem[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.margin[_ngcontent-%COMP%]{margin:20px;display:flex;justify-content:flex-end;max-width:80px;text-align:right}ion-input[_ngcontent-%COMP%]{--padding-start: 10px !important;--text-align: left !important}.text[_ngcontent-%COMP%]{font-size:.8em;margin-top:10px;font-weight:600}.info[_ngcontent-%COMP%]{padding-left:2px;margin-bottom:15px;margin-top:-20px;font-weight:700;font-size:.95em}.btm-border[_ngcontent-%COMP%]{border-bottom:1px solid rgba(223,223,223,.733)}.light-label[_ngcontent-%COMP%]{color:#000;font-size:.7em;margin-top:4px;float:right;font-weight:400!important}"]}),v})()}];let J=(()=>{var a;class v{}return(a=v).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[m.iI.forChild(z),m.iI]}),v})();var Q=i(7019),Z=i(1683);let ee=(()=>{var a;class v{}return(a=v).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[o.MD,_.YN,t.bv,J,Q.h,l.h,Z.Y]}),v})()},6090:(x,D,i)=>{i.d(D,{v:()=>e});var o=i(1916),_=i(4438),t=i(1204),m=i(9598),d=i(4742),g=i(230),b=i(5151),T=i(9196);let e=(()=>{var M;class l extends o.${constructor(p,P,S,A,B,u){super(S,A,B),this.account=p,this.router=P,this.userInfoProvider=u}ionViewDidLoad(){}ionViewWillEnter(){}ionViewDidEnter(){}ionViewWillLeave(){}ionViewDidLeave(){}ionViewWillUnload(){}ionViewCanEnter(){return!0}ionViewCanLeave(){return!0}navTo(p,P){const S=Array.isArray(p)?p:[p];this.router.navigate(S,P)}navToUrl(p,P){this.router.navigateByUrl(p,P)}}return(M=l).\u0275fac=function(p){return new(p||M)(_.rXU(t.$),_.rXU(m.Ix),_.rXU(d.Xi),_.rXU(g.c$),_.rXU(b.p),_.rXU(T.Z))},M.\u0275cmp=_.VBU({type:M,selectors:[["ng-component"]],features:[_.Vt3],decls:0,vars:0,template:function(p,P){}}),l})()},8330:(x,D,i)=>{i.d(D,{M:()=>B});var o=i(467),_=i(1876),t=i(4438),m=i(4742),d=i(3656),g=i(230),b=i(177);function T(u,C){if(1&u){const h=t.RV6();t.j41(0,"ion-button",1),t.bIt("click",function(){t.eBV(h);const R=t.XpG();return t.Njj(R.dismiss())}),t.EFF(1),t.nI1(2,"translate"),t.k0s()}2&u&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"DONE")," "))}function e(u,C){if(1&u&&(t.j41(0,"p",6),t.EFF(1),t.k0s()),2&u){const h=t.XpG();t.R7$(),t.JRh(h.emptyLabel)}}function M(u,C){if(1&u){const h=t.RV6();t.j41(0,"ion-searchbar",8),t.nI1(1,"translate"),t.bIt("ionInput",function(R){t.eBV(h);const O=t.XpG(2);return t.Njj(O.onSearchInput(R))}),t.k0s()}2&u&&t.FS9("placeholder",t.bMT(1,1,"SEARCH"))}function l(u,C){if(1&u){const h=t.RV6();t.j41(0,"ion-item")(1,"ion-label"),t.EFF(2),t.k0s(),t.j41(3,"ion-checkbox",10),t.bIt("ionChange",function(){const R=t.eBV(h).$implicit,O=t.XpG(3);return t.Njj(O.onClickItem(R))}),t.k0s()()}if(2&u){const h=C.$implicit,f=t.XpG(3);t.R7$(2),t.JRh(h.name),t.R7$(),t.Y8G("checked",f.isSelected(h))}}function E(u,C){if(1&u&&(t.j41(0,"ion-list"),t.DNE(1,l,4,2,"ion-item",9),t.k0s()),2&u){const h=t.XpG(2);t.R7$(),t.Y8G("ngForOf",h.filteredItems)}}function p(u,C){if(1&u&&(t.j41(0,"div")(1,"ion-label",13),t.EFF(2),t.k0s()()),2&u){const h=t.XpG().$implicit;t.R7$(2),t.JRh(h.schoolName)}}function P(u,C){if(1&u){const h=t.RV6();t.j41(0,"ion-item",12),t.bIt("click",function(){const R=t.eBV(h).$implicit,O=t.XpG(3);return t.Njj(O.onClickItem(R))}),t.j41(1,"ion-label"),t.EFF(2),t.k0s(),t.DNE(3,p,3,1,"div",5),t.k0s()}if(2&u){const h=C.$implicit;t.R7$(2),t.JRh(h.name),t.R7$(),t.Y8G("ngIf",h.schoolName)}}function S(u,C){if(1&u&&(t.j41(0,"ion-list"),t.DNE(1,P,4,2,"ion-item",11),t.k0s()),2&u){const h=t.XpG(2);t.R7$(),t.Y8G("ngForOf",h.filteredItems)}}function A(u,C){if(1&u&&(t.qex(0),t.DNE(1,M,2,3,"ion-searchbar",7)(2,E,2,1,"ion-list",5)(3,S,2,1,"ion-list",5),t.bVm()),2&u){const h=t.XpG();t.R7$(),t.Y8G("ngIf",h.isSearchVisible),t.R7$(),t.Y8G("ngIf",h.isMultiSelect),t.R7$(),t.Y8G("ngIf",!h.isMultiSelect)}}let B=(()=>{var u;class C{constructor(f,R,O){this.modalCtrl=f,this.navParams=R,this.translate=O,this.isSearching=!1,this.filteredItems=[],this.selection=new _.Y}ionViewWillEnter(){var f=this;return(0,o.A)(function*(){yield f.initLang(),f.initView()})()}get isSearchVisible(){return this.items&&this.items.length>10}isSelected(f){return this.selection.isSelected(f)}onClickItem(f){this.isMultiSelect?this.toggleSelection(f):(this.selection.selectItem(f),this.dismiss())}onSearchInput(f){let R=f.target.value||"";this.filteredItems=this.items.filter(O=>this.match(R,O))}dismiss(){let f=this.selection.selectedItems;0===f.length?this.modalCtrl.dismiss():this.modalCtrl.dismiss(this.isMultiSelect?{items:f}:{item:f[0]})}initLang(){this.translate.setDefaultLang("sv");const f=this.translate.getBrowserLang();f&&f.startsWith("en")?this.translate.use("en"):this.translate.use("sv"),this.translate.get(["SELECTABLE_OPTIONS_MISSING","SELECT_ONE_OR_MORE","SELECT_ONE"]).subscribe(O=>{this.translations=O})}initView(){this.selection=new _.Y,this.emptyLabel=this.navParams.data.emptyLabel||this.translations.SELECTABLE_OPTIONS_MISSING,this.isMultiSelect=this.navParams.data.multi,this.title=this.navParams.data.title||(this.isMultiSelect?this.translations.SELECT_ONE_OR_MORE:this.translations.SELECT_ONE),this.items=this.navParams.data.items,this.isEmpty=0==this.items.length,this.selection.setSelectedItems(this.navParams.data.selectedItems||[]),this.filteredItems=this.items}match(f,R){let O=f.toLocaleLowerCase();return R.name.toLocaleLowerCase().indexOf(O)>-1}toggleSelection(f){this.selection.toggleItem(f)}}return(u=C).\u0275fac=function(f){return new(f||u)(t.rXU(m.W3),t.rXU(d.y8),t.rXU(g.c$))},u.\u0275cmp=t.VBU({type:u,selectors:[["page-picker"]],decls:14,vars:7,consts:[["slot","start"],["fill","clear",3,"click"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],["class","ion-padding ion-text-center",4,"ngIf"],[4,"ngIf"],[1,"ion-padding","ion-text-center"],["autocapitalize","off",3,"placeholder","ionInput",4,"ngIf"],["autocapitalize","off",3,"ionInput","placeholder"],[4,"ngFor","ngForOf"],["item-end","",3,"ionChange","checked"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[2,"color","black","font-size","0.7em"]],template:function(f,R){1&f&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.bIt("click",function(){return R.dismiss()}),t.j41(4,"span"),t.EFF(5),t.nI1(6,"translate"),t.k0s()()(),t.j41(7,"ion-title"),t.EFF(8),t.k0s(),t.j41(9,"ion-buttons",2),t.DNE(10,T,3,3,"ion-button",3),t.k0s()()(),t.j41(11,"ion-content"),t.DNE(12,e,2,1,"p",4)(13,A,4,3,"ng-container",5),t.k0s()),2&f&&(t.R7$(5),t.JRh(t.bMT(6,5,"CANCEL")),t.R7$(3),t.JRh(R.title),t.R7$(2),t.Y8G("ngIf",R.isMultiSelect),t.R7$(2),t.Y8G("ngIf",R.isEmpty),t.R7$(),t.Y8G("ngIf",!R.isEmpty))},dependencies:[b.Sq,b.bT,m.Jm,m.QW,m.eY,m.W9,m.eU,m.uz,m.he,m.nf,m.S1,m.BC,m.ai,m.hB,m.Gw,g.D9],encapsulation:2}),C})()},1204:(x,D,i)=>{i.d(D,{$:()=>P});var o=i(467),_=i(4438),t=i(4538),m=i(5320),d=i(9196),g=i(772),b=i(6186),T=i(2840),e=i(3656),M=i(2457),l=i(4840),E=i(7643),p=i(2618);let P=(()=>{var S;class A{constructor(u,C,h,f,R,O,L,F,G,$,k){this.loginSchool=u,this.token=C,this.userInfo=h,this.userSettings=f,this.loginStatus=R,this.roleService=O,this.platform=L,this.push=F,this.rolesProvider=G,this.moduleService=$,this.moduleSettingProvider=k}clearStudentCardPage(){this.studentCardPage&&this.studentCardPage.ngOnDestroy()}logout(){this.token.clearToken(),this.userInfo.clear(),this.rolesProvider.clear(),this.moduleSettingProvider.clear(),this.clearStudentCardPage(),this.loginStatus.setStatus(!1),(this.platform.is("capacitor")||this.platform.is("cordova"))&&this.push.removePushToken()}changeRole(u,C){var h=this;return(0,o.A)(function*(){const f=yield h.roleService.changeRole(u,C);yield h.token.updateToken(f),h.userInfo.refresh();let R=yield h.userInfo.init();h.loginStatus.setRole(R.roleName),h.moduleSettingProvider.updateModuleSettings()})()}logOutAndForgetSchool(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}logOutAndForgetSchoolAndSettings(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}}return(S=A).\u0275fac=function(u){return new(u||S)(_.KVO(t.d),_.KVO(m.x),_.KVO(d.Z),_.KVO(g.w),_.KVO(b.B),_.KVO(T.W),_.KVO(e.OD),_.KVO(M.T),_.KVO(l.L),_.KVO(E.v),_.KVO(p.C))},S.\u0275prov=_.jDH({token:S,factory:S.\u0275fac,providedIn:"root"}),A})()},2129:(x,D,i)=>{i.d(D,{h:()=>t});var o=i(467),_=i(1622);class t extends _.D{constructor(d,g){super(),this.api=d,this.loginStatus=g,this.list=[],this.setupClearOnLogout()}clear(){this.list=[]}init(d){var g=this;return(0,o.A)(function*(){let b=JSON.stringify(d);return b!=g.stringifiedParams&&(g.clear(),g.stringifiedParams=b),g.list.length||(g.list=yield g.loadList(d)),g.list})()}refresh(){var d=this;return(0,o.A)(function*(){return d.list=[],d.init()})()}loadList(d){return this.api.get(this.listEndpoint,d)}setupClearOnLogout(){this.addSub(this.loginStatus.isLoggedInState.subscribe(d=>{d||this.clear()}))}}},6969:(x,D,i)=>{i.d(D,{s:()=>d});var o=i(2129),_=i(4438),t=i(6244),m=i(6186);let d=(()=>{var g;class b extends o.h{constructor(e,M){super(e,M),this.listEndpoint="api/students/list?includeallschools=true",this.setupClearOnRoleChange()}setupClearOnRoleChange(){this.addSub(this.loginStatus.roleNameState.subscribe(e=>{e&&this.clear()}))}}return(g=b).\u0275fac=function(e){return new(e||g)(_.KVO(t.j),_.KVO(m.B))},g.\u0275prov=_.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),b})()}}]);