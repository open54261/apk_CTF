"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4640],{4640:(N,c,i)=>{i.r(c),i.d(c,{LoginBankidPageModule:()=>C});var u=i(230),s=i(4742),m=i(7019),l=i(9598),g=i(467),k=i(6090),d=i(5383),n=i(4438),P=i(1204),B=i(3656),R=i(5151),I=i(9196),L=i(6834),S=i(2457),f=i(177),y=i(8924),h=i(60);function b(t,r){if(1&t&&n.nrm(0,"fa-icon",7),2&t){const a=n.XpG();n.Y8G("icon",a.faWarning)}}function X(t,r){if(1&t&&n.nrm(0,"fa-icon",8),2&t){const a=n.XpG();n.Y8G("icon",a.faSpinner)("pulse",!0)("fixedWidth",!0)}}function G(t,r){if(1&t){const a=n.RV6();n.j41(0,"ion-button",9),n.bIt("click",function(){n.eBV(a);const o=n.XpG();return n.Njj(o.cancel())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&t&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"CANCEL")," "))}const U=[{path:"",component:(()=>{var t;class r extends k.v{constructor(e,o,v,M,j,p,F,$,x,Y,D){super(e,v,o,M,j,p),this.userInfo=p,this.bankIdService=F,this.navCtrl=$,this.route=x,this.push=Y,this.routers=D,this.status="pending",this.timeout=-1,this.faSpinner=d.z1G,this.faWarning=d.QJT}ngOnInit(){this.orderRef=this.route.snapshot.queryParamMap.get("orderRef")||this.orderRef,this.orderRef?this.orderRef&&-1===this.timeout&&(this.userAlertService.debug("start polling ref "+this.orderRef),this.pollForStatus()):this.userAlertService.error("no BankID orderRef")}ngOnDestroy(){this.stopPolling(),super.ionViewDidLeave()}get canCancel(){return"pending"===this.status&&this.orderRef}cancel(){var e=this;return(0,g.A)(function*(){e.stopPolling(),yield e.withSpinner(()=>e.bankIdService.cancel(e.orderRef),"Avbryter inloggning med BankID"),e.navCtrl.back()})()}pollForStatus(){var e=this;this.timeout=setTimeout((0,g.A)(function*(){return yield e.getStatus()}),2e3)}stopPolling(){-1!==this.timeout&&(clearTimeout(this.timeout),this.timeout=-1)}getStatus(){var e=this;return(0,g.A)(function*(){e.userAlertService.debug("Polling order "+e.orderRef);let o=yield e.bankIdService.getStatus(e.orderRef);switch(o&&(e.status=o.status,e.message=o.message),e.status){case"complete":e.userAlertService.debug("complete"),yield e.signin();break;case"failed":e.userAlertService.debug("failed"),e.stopPolling();break;case"pending":e.userAlertService.debug("pending"),e.pollForStatus()}})()}signin(){var e=this;return(0,g.A)(function*(){e.stopPolling();let o=!1;try{yield e.bankIdService.signin(e.orderRef),o=!0}catch(v){e.status="failed",e.message="Inloggningen misslyckades"}e.orderRef=void 0,o&&(e.push.init(),e.routers.navigateByUrl("tabs",{replaceUrl:!0}))})()}}return(t=r).\u0275fac=function(e){return new(e||t)(n.rXU(P.$),n.rXU(s.Xi),n.rXU(l.Ix),n.rXU(u.c$),n.rXU(R.p),n.rXU(I.Z),n.rXU(L.J),n.rXU(B.q9),n.rXU(l.nX),n.rXU(S.T),n.rXU(l.Ix))},t.\u0275cmp=n.VBU({type:t,selectors:[["page-login-bankid"]],features:[n.Vt3],decls:11,vars:6,consts:[[3,"translucent"],["pageTitle","LOGIN_AT",3,"backPage"],[1,"ion-padding"],[1,"ion-justify-content-center","ion-align-items-center"],[3,"icon",4,"ngIf"],["size","lg",3,"icon","pulse","fixedWidth",4,"ngIf"],["fill","outline","class","btn-bankid",3,"click",4,"ngIf"],[3,"icon"],["size","lg",3,"icon","pulse","fixedWidth"],["fill","outline",1,"btn-bankid",3,"click"]],template:function(e,o){1&e&&(n.j41(0,"ion-header",0),n.nrm(1,"app-login-header",1),n.k0s(),n.j41(2,"ion-content",2)(3,"ion-grid")(4,"ion-row",3),n.DNE(5,b,1,1,"fa-icon",4)(6,X,1,3,"fa-icon",5),n.k0s(),n.j41(7,"ion-row",3),n.EFF(8),n.k0s(),n.j41(9,"ion-row",3),n.DNE(10,G,3,3,"ion-button",6),n.k0s()()()),2&e&&(n.Y8G("translucent",!0),n.R7$(),n.Y8G("backPage","/login"),n.R7$(4),n.Y8G("ngIf","failed"===o.status),n.R7$(),n.Y8G("ngIf","pending"===o.status),n.R7$(2),n.SpI(" ",o.message," "),n.R7$(2),n.Y8G("ngIf",o.canCancel))},dependencies:[f.bT,s.Jm,s.W9,s.lO,s.eU,s.ln,y.C,h.aY,u.D9]}),r})()}];let T=(()=>{var t;class r{}return(t=r).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.$C({type:t}),t.\u0275inj=n.G2t({imports:[l.iI.forChild(U),l.iI]}),r})();var A=i(9417);let C=(()=>{var t;class r{}return(t=r).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.$C({type:t}),t.\u0275inj=n.G2t({imports:[f.MD,A.YN,s.bv,T,u.h,m.h,h.dX]}),r})()}}]);