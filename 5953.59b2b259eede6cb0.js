"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5953],{1916:(R,O,t)=>{t.d(O,{$:()=>n});var i=t(467),o=t(3207),p=t(4438),E=t(4742),f=t(230),u=t(5151);let n=(()=>{var c;class P{constructor(e,l,a){this.loadingCtrl=e,this.translateService=l,this.userAlertService=a,this.subscriptions=[],this.showLoading=!1,this.loadingDismissTimeout=-1,this.loadingDismissTimeoutMS=3e4}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}addSub(e){this.subscriptions.push(e)}translate(e,l){var a=this;return(0,i.A)(function*(){return(yield(0,o.s)(a.translateService.get(e)))||l||e})()}withSpinner(e,l,a){var g=this;return(0,i.A)(function*(){let h;yield g.presentLoading(l),g.loadingDismissTimeout=setTimeout(()=>g.timeoutLoading(a),g.loadingDismissTimeoutMS);try{h=yield e()}catch(v){g.userAlertService.debug(v)}return yield g.dismissLoading(),h})()}timeoutLoading(e){var l=this;return(0,i.A)(function*(){e||(e=yield l.translate("LOADING_FAILED")),l.userAlertService.error(e),yield l.dismissLoading()})()}dismissLoading(){var e=this;return(0,i.A)(function*(){-1!=e.loadingDismissTimeout&&(clearTimeout(e.loadingDismissTimeout),e.loadingDismissTimeout=-1),e.showLoading=!1,(yield e.loadingCtrl.getTop())&&(yield e.loadingCtrl.dismiss(null))})()}presentLoading(e){var l=this;return(0,i.A)(function*(){return l.showLoading=!0,yield l.loadingCtrl.create({message:e}).then(a=>{a.present().then(()=>{l.showLoading&&a.dismiss()})})})()}}return(c=P).\u0275fac=function(e){return new(e||c)(p.rXU(E.Xi),p.rXU(f.c$),p.rXU(u.p))},c.\u0275cmp=p.VBU({type:c,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,l){},encapsulation:2}),P})()},2952:(R,O,t)=>{t.d(O,{t:()=>f});var i=t(4438),o=t(4742),p=t(177);function E(u,n){if(1&u&&(i.j41(0,"p"),i.EFF(1),i.k0s()),2&u){const c=i.XpG();i.R7$(),i.JRh(c.text)}}let f=(()=>{var u;class n{constructor(){this.text=""}}return(u=n).\u0275fac=function(P){return new(P||u)},u.\u0275cmp=i.VBU({type:u,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(P,_){2&P&&i.HbH(_.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(P,_){1&P&&(i.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),i.nrm(3,"ion-spinner"),i.DNE(4,E,2,1,"p",3),i.k0s()()()),2&P&&(i.R7$(4),i.Y8G("ngIf",_.text))},dependencies:[o.hU,o.lO,o.ln,o.w2,p.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),n})()},6090:(R,O,t)=>{t.d(O,{v:()=>P});var i=t(1916),o=t(4438),p=t(1204),E=t(9598),f=t(4742),u=t(230),n=t(5151),c=t(9196);let P=(()=>{var _;class e extends i.${constructor(a,g,h,v,T,L){super(h,v,T),this.account=a,this.router=g,this.userInfoProvider=L}ionViewDidLoad(){}ionViewWillEnter(){}ionViewDidEnter(){}ionViewWillLeave(){}ionViewDidLeave(){}ionViewWillUnload(){}ionViewCanEnter(){return!0}ionViewCanLeave(){return!0}navTo(a,g){const h=Array.isArray(a)?a:[a];this.router.navigate(h,g)}navToUrl(a,g){this.router.navigateByUrl(a,g)}}return(_=e).\u0275fac=function(a){return new(a||_)(o.rXU(p.$),o.rXU(E.Ix),o.rXU(f.Xi),o.rXU(u.c$),o.rXU(n.p),o.rXU(c.Z))},_.\u0275cmp=o.VBU({type:_,selectors:[["ng-component"]],features:[o.Vt3],decls:0,vars:0,template:function(a,g){}}),e})()},5953:(R,O,t)=>{t.r(O),t.d(O,{LoginPasswordPageModule:()=>B});var i=t(230),o=t(4742),p=t(7019),E=t(9598),f=t(467),u=t(6090),n=t(4438),c=t(1204),P=t(5151),_=t(9196),e=t(1339),l=t(4538),a=t(6186),g=t(2457),h=t(177),v=t(9417),T=t(2952),L=t(8924);function U(r,M){1&r&&n.nrm(0,"q-spinner",4)}function D(r,M){if(1&r){const m=n.RV6();n.j41(0,"form",5),n.bIt("submit",function(){n.eBV(m);const d=n.XpG();return n.Njj(d.loginWithPassword())}),n.j41(1,"ion-list")(2,"ion-item")(3,"ion-label",6),n.EFF(4),n.nI1(5,"translate"),n.k0s(),n.j41(6,"ion-input",7),n.mxI("ngModelChange",function(d){n.eBV(m);const C=n.XpG();return n.DH7(C.username,d)||(C.username=d),n.Njj(d)}),n.k0s()(),n.j41(7,"ion-item")(8,"ion-label",6),n.EFF(9),n.nI1(10,"translate"),n.k0s(),n.j41(11,"ion-input",8),n.mxI("ngModelChange",function(d){n.eBV(m);const C=n.XpG();return n.DH7(C.password,d)||(C.password=d),n.Njj(d)}),n.k0s()(),n.j41(12,"div",9)(13,"ion-button",10),n.EFF(14),n.nI1(15,"translate"),n.k0s()()()()}if(2&r){const m=n.XpG();n.R7$(4),n.JRh(n.bMT(5,5,"USERNAME")),n.R7$(2),n.R50("ngModel",m.username),n.R7$(3),n.JRh(n.bMT(10,7,"PASSWORD")),n.R7$(2),n.R50("ngModel",m.password),n.R7$(3),n.SpI(" ",n.bMT(15,9,"LOGIN_BUTTON")," ")}}const I=[{path:"",component:(()=>{var r;class M extends u.v{constructor(s,d,C,K,W,V,x,X,j,F,G,w){super(s,C,d,W,V,x),this.routers=K,this.toastCtrl=X,this.authService=j,this.loginSchool=F,this.loginStatus=G,this.push=w,this.isInitialized=!1,this.toastCtrl.create({animated:!1}).then(y=>{y.present(),y.dismiss()})}ngOnInit(){var s=this;return(0,f.A)(function*(){yield s.initView(),s.isInitialized=!0})()}get schoolName(){return this.school?this.school.name:"din skola"}loginWithPassword(){this.authService.loginWithPassword(this.username,this.password).then(s=>{this.loginStatus.isLoggedIn?(this.push.init(),this.ngOnDestroy(),this.routers.navigateByUrl("tabs",{replaceUrl:!0})):this.afterLoginFail()},s=>{this.afterLoginFail()}).catch(s=>{this.afterLoginFail2()})}afterLoginFail(){var s=this;return(0,f.A)(function*(){s.navTo("login"),(yield s.toastCtrl.create({message:s.loginErrorString,duration:3e3,position:"top"})).present()})()}afterLoginFail2(){var s=this;return(0,f.A)(function*(){(yield s.toastCtrl.create({message:s.loginErrorString2,duration:3e3,position:"top"})).present()})()}initView(){var s=this;return(0,f.A)(function*(){s.school=yield s.loginSchool.getLoginSchool(),s.loginErrorString=yield s.translate("LOGIN_ERROR"),s.loginErrorString2=yield s.translate("LOGIN_UNAVAILABLE_ERROR")})()}}return(r=M).\u0275fac=function(s){return new(s||r)(n.rXU(c.$),n.rXU(o.Xi),n.rXU(E.Ix),n.rXU(E.Ix),n.rXU(i.c$),n.rXU(P.p),n.rXU(_.Z),n.rXU(o.K_),n.rXU(e.u),n.rXU(l.d),n.rXU(a.B),n.rXU(g.T))},r.\u0275cmp=n.VBU({type:r,selectors:[["page-login-password"]],features:[n.Vt3],decls:5,vars:5,consts:[[3,"translucent"],[3,"pageTitle","backPage"],["class","ion-margin-top",4,"ngIf"],[3,"submit",4,"ngIf"],[1,"ion-margin-top"],[3,"submit"],["position","stacked"],["type","text","autocapitalize","off","name","username",3,"ngModelChange","ngModel"],["type","password","name","password",3,"ngModelChange","ngModel"],[1,"ion-padding"],["fill","outline","color","primary","expand","block","type","submit"]],template:function(s,d){1&s&&(n.j41(0,"ion-header",0),n.nrm(1,"app-login-header",1),n.k0s(),n.j41(2,"ion-content"),n.DNE(3,U,1,0,"q-spinner",2)(4,D,16,11,"form",3),n.k0s()),2&s&&(n.Y8G("translucent",!0),n.R7$(),n.Y8G("pageTitle",d.schoolName)("backPage","/login"),n.R7$(2),n.Y8G("ngIf",!d.isInitialized),n.R7$(),n.Y8G("ngIf",d.isInitialized))},dependencies:[h.bT,v.qT,v.BC,v.cb,v.vS,v.cV,o.Jm,o.W9,o.eU,o.$w,o.uz,o.he,o.nf,o.Gw,T.t,L.C,i.D9]}),M})()}];let S=(()=>{var r;class M{}return(r=M).\u0275fac=function(s){return new(s||r)},r.\u0275mod=n.$C({type:r}),r.\u0275inj=n.G2t({imports:[E.iI.forChild(I),E.iI]}),M})(),B=(()=>{var r;class M{}return(r=M).\u0275fac=function(s){return new(s||r)},r.\u0275mod=n.$C({type:r}),r.\u0275inj=n.G2t({imports:[h.MD,v.YN,o.bv,S,i.h,p.h]}),M})()},1204:(R,O,t)=>{t.d(O,{$:()=>g});var i=t(467),o=t(4438),p=t(4538),E=t(5320),f=t(9196),u=t(772),n=t(6186),c=t(2840),P=t(3656),_=t(2457),e=t(4840),l=t(7643),a=t(2618);let g=(()=>{var h;class v{constructor(L,U,D,A,I,S,B,r,M,m,s){this.loginSchool=L,this.token=U,this.userInfo=D,this.userSettings=A,this.loginStatus=I,this.roleService=S,this.platform=B,this.push=r,this.rolesProvider=M,this.moduleService=m,this.moduleSettingProvider=s}clearStudentCardPage(){this.studentCardPage&&this.studentCardPage.ngOnDestroy()}logout(){this.token.clearToken(),this.userInfo.clear(),this.rolesProvider.clear(),this.moduleSettingProvider.clear(),this.clearStudentCardPage(),this.loginStatus.setStatus(!1),(this.platform.is("capacitor")||this.platform.is("cordova"))&&this.push.removePushToken()}changeRole(L,U){var D=this;return(0,i.A)(function*(){const A=yield D.roleService.changeRole(L,U);yield D.token.updateToken(A),D.userInfo.refresh();let I=yield D.userInfo.init();D.loginStatus.setRole(I.roleName),D.moduleSettingProvider.updateModuleSettings()})()}logOutAndForgetSchool(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}logOutAndForgetSchoolAndSettings(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}}return(h=v).\u0275fac=function(L){return new(L||h)(o.KVO(p.d),o.KVO(E.x),o.KVO(f.Z),o.KVO(u.w),o.KVO(n.B),o.KVO(c.W),o.KVO(P.OD),o.KVO(_.T),o.KVO(e.L),o.KVO(l.v),o.KVO(a.C))},h.\u0275prov=o.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),v})()}}]);