"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9512],{2952:(E,P,e)=>{e.d(P,{t:()=>c});var a=e(4438),s=e(4742),_=e(177);function p(l,n){if(1&l&&(a.j41(0,"p"),a.EFF(1),a.k0s()),2&l){const u=a.XpG();a.R7$(),a.JRh(u.text)}}let c=(()=>{var l;class n{constructor(){this.text=""}}return(l=n).\u0275fac=function(d){return new(d||l)},l.\u0275cmp=a.VBU({type:l,selectors:[["q-spinner"]],hostVars:2,hostBindings:function(d,S){2&d&&a.HbH(S.expand)},inputs:{text:"text",expand:"expand"},decls:5,vars:1,consts:[[1,"ion-no-padding","ion-no-margin"],[1,"ion-justify-content-center","ion-align-items-center"],[1,"ion-text-center"],[4,"ngIf"]],template:function(d,S){1&d&&(a.j41(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),a.nrm(3,"ion-spinner"),a.DNE(4,p,2,1,"p",3),a.k0s()()()),2&d&&(a.R7$(4),a.Y8G("ngIf",S.text))},dependencies:[s.hU,s.lO,s.ln,s.w2,_.bT],styles:[".expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{height:100%}.expand[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:var(--quiculum-gray)}"]}),n})()},9512:(E,P,e)=>{e.r(P),e.d(P,{LoginPageModule:()=>K});var a=e(177),s=e(4742),_=e(9417),p=e(9598),c=e(467),l=e(3207),n=e(4438),u=e(4538),d=e(230),S=e(8775);let T=(()=>{var i;class g{constructor(o,t){this.loginSchoolProvider=o,this.modalCtrl=t,this.initView()}get loginHelp(){return this.loginSchool?this.loginSchool.loginHelp:""}initView(){var o=this;return(0,c.A)(function*(){o.loginSchool=yield o.loginSchoolProvider.getLoginSchool()})()}dismiss(){this.modalCtrl.dismiss()}}return(i=g).\u0275fac=function(o){return new(o||i)(n.rXU(u.d),n.rXU(s.W3))},i.\u0275cmp=n.VBU({type:i,selectors:[["page-login-help"]],decls:12,vars:9,consts:[["slot","end"],["fill","clear",3,"click"],[1,"ion-padding"],[3,"innerHtml"]],template:function(o,t){1&o&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.EFF(3),n.nI1(4,"translate"),n.k0s(),n.j41(5,"ion-buttons",0)(6,"ion-button",1),n.bIt("click",function(){return t.dismiss()}),n.EFF(7),n.nI1(8,"translate"),n.k0s()()()(),n.j41(9,"ion-content",2),n.nrm(10,"div",3),n.nI1(11,"nlHtml"),n.k0s()),2&o&&(n.R7$(3),n.JRh(n.bMT(4,3,"LOGIN_HELP")),n.R7$(4),n.SpI(" ",n.bMT(8,5,"DONE")," "),n.R7$(3),n.Y8G("innerHtml",n.bMT(11,7,t.loginHelp),n.npT))},dependencies:[s.Jm,s.QW,s.W9,s.eU,s.BC,s.ai,d.D9,S.V],encapsulation:2}),g})();var C=e(1626),k=e(1339),R=e(5151),m=e(772),I=e(1204),x=e(6834),L=e(8034),M=e(6473),f=e(2457),b=e(2952),O=e(8924);function D(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-fab",10),n.bIt("click",function(){n.eBV(r);const t=n.XpG();return n.Njj(t.openHelp())}),n.j41(1,"ion-fab-button",11),n.nrm(2,"ion-icon",12),n.k0s()()}}function U(i,g){if(1&i){const r=n.RV6();n.qex(0),n.j41(1,"ion-button",13),n.bIt("click",function(){n.eBV(r);const t=n.XpG();return n.Njj(t.selectSchool())}),n.EFF(2),n.nI1(3,"translate"),n.k0s(),n.bVm()}2&i&&(n.R7$(2),n.SpI(" ",n.bMT(3,1,"SELECT_SCHOOL")," "))}function A(i,g){1&i&&n.nrm(0,"q-spinner",14)}function W(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-button",17),n.bIt("click",function(){n.eBV(r);const t=n.XpG(2);return n.Njj(t.loginWithBankID())}),n.nrm(1,"img",18),n.EFF(2),n.nI1(3,"translate"),n.j41(4,"span",19),n.EFF(5,"\xa0BankID"),n.k0s()()}2&i&&(n.R7$(2),n.SpI(" ",n.bMT(3,1,"LOGIN_WITH")," "))}function V(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-button",13),n.bIt("click",function(){n.eBV(r);const t=n.XpG(2);return n.Njj(t.loginWithSSO())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&i&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"LOGIN_WITH_SSO")," "))}function y(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-button",13),n.bIt("click",function(){n.eBV(r);const t=n.XpG(2);return n.Njj(t.loginWithGoogle())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&i&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"LOGIN_WITH_GOOGLE")," "))}function j(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-button",13),n.bIt("click",function(){n.eBV(r);const t=n.XpG(2);return n.Njj(t.loginWithMicrosoft())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&i&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"LOGIN_WITH_MICROSOFT")," "))}function B(i,g){if(1&i){const r=n.RV6();n.j41(0,"ion-button",13),n.bIt("click",function(){n.eBV(r);const t=n.XpG(2);return n.Njj(t.loginWithPassword())}),n.EFF(1),n.nI1(2,"translate"),n.k0s()}2&i&&(n.R7$(),n.SpI(" ",n.bMT(2,1,"LOGIN_WITH_PASSWORD")," "))}function G(i,g){if(1&i&&(n.qex(0),n.DNE(1,W,6,3,"ion-button",15)(2,V,3,3,"ion-button",16)(3,y,3,3,"ion-button",16)(4,j,3,3,"ion-button",16)(5,B,3,3,"ion-button",16),n.bVm()),2&i){const r=n.XpG();n.R7$(),n.Y8G("ngIf",r.bankIdLoginEnabled),n.R7$(),n.Y8G("ngIf",r.samlLoginEnabled),n.R7$(),n.Y8G("ngIf",r.googleLoginEnabled),n.R7$(),n.Y8G("ngIf",r.microsoftLoginEnabled),n.R7$(),n.Y8G("ngIf",r.passwordLoginEnabled)}}const $=[{path:"",component:(()=>{var i;class g{constructor(o,t,h,v,H,X,z,Y,w,J,Q,Z,q){this.http=o,this.route=t,this.router=h,this.authService=v,this.userAlertService=H,this.userSettingsProvider=X,this.accountProvider=z,this.loginSchoolProvider=Y,this.bankidService=w,this.modalCtrl=J,this.tokenService=Q,this.browserService=Z,this.push=q,this.loginMethodsEndpoint="{school}/applogin/methods",this.isLoadingLoginMethods=!1,this.loginMethods=[],this.subscriptions=[],t.queryParams.subscribe(nn=>{this.initializeView(nn)})}ngOnInit(){var o=this;const t=this.loginSchoolProvider.loginSchoolState.subscribe(function(){var h=(0,c.A)(function*(v){o.loginSchool=v,o.initializeView()});return function(v){return h.apply(this,arguments)}}());this.subscriptions.push(t)}ngAfterViewInit(){this.initializeView()}ngOnDestroy(){this.subscriptions.forEach(o=>o.unsubscribe())}ionViewWillUnload(){this.browser&&this.browser.close()}openHelp(){var o=this;return(0,c.A)(function*(){yield(yield o.modalCtrl.create({component:T})).present()})()}initializeView(o){var t=this;return(0,c.A)(function*(){o&&o.access_token||t.route.snapshot.queryParamMap.get("access_token")?yield t.loginWithTokenInNavParams(o):(t.loginSchool=yield t.loginSchoolProvider.getLoginSchool(),t.loginSchool&&(t.isLoadingLoginMethods=!0,t.loginMethods=yield t.getLoginMethods(t.loginSchool.urlString),t.isLoadingLoginMethods=!1))})()}get isSchoolSelected(){return!!this.loginSchool}get schoolName(){var o;return(null===(o=this.loginSchool)||void 0===o?void 0:o.name)||""}get bankIdLoginEnabled(){return this.loginMethods.indexOf("BankID")>-1}get googleLoginEnabled(){return this.loginMethods.indexOf("Google")>-1}get microsoftLoginEnabled(){return this.loginMethods.indexOf("Microsoft")>-1}get passwordLoginEnabled(){return this.loginMethods.indexOf("Password")>-1}get samlLoginEnabled(){return this.loginMethods.indexOf("SAML")>-1}loginWithPassword(){this.saveLoginPage("LoginPasswordPage"),this.router.navigate(["login-password"])}loginWithBankID(){var o=this;return(0,c.A)(function*(){let t=yield o.bankidService.openBankIDApp();o.userAlertService.debug("orderRef: "+t),o.bankidService.getStatus(t),o.router.navigate(["login/bankid"],{queryParams:{orderRef:t}})})()}loginWithSSO(){var o=this;return(0,c.A)(function*(){let t=yield o.loginSchoolProvider.getLoginSchool();o.openUrl(`https://${t.host}/${t.urlString}/applogin/v2/saml`)})()}loginWithGoogle(){var o=this;return(0,c.A)(function*(){let t=yield o.loginSchoolProvider.getLoginSchool();o.openUrl(`https://${t.host}/${t.urlString}/applogin/v2/google`)})()}loginWithMicrosoft(){var o=this;return(0,c.A)(function*(){let t=yield o.loginSchoolProvider.getLoginSchool();o.openUrl(`https://${t.host}/${t.urlString}/applogin/v2/microsoft`)})()}logout(){this.accountProvider.logout(),window.location.reload()}selectSchool(){this.loginSchool=void 0,this.router.navigate(["login-schools"])}getLoginMethods(o){var t=this;return(0,c.A)(function*(){let h=t.loginMethodsEndpoint.replace("{school}",o),v=`https://${t.loginSchool.host}/${h}`;return yield(0,l.s)(t.http.get(v))})()}loginWithTokenInNavParams(o){var t=this;return(0,c.A)(function*(){const h=o||(yield Promise.resolve(t.route.snapshot.queryParams));let v=t.tokenService.readTokenFromObject(h);v&&(yield t.authService.afterLoginSuccess(v),t.userAlertService.debug("Navigating to TabsPage"),t.push.init(),t.router.navigate(["tabs"],{replaceUrl:!0}))})()}openUrl(o){this.browserService.openUrl(o)}saveLoginPage(o){let t=this.userSettingsProvider.userSettings;t.loginPage=o,this.userSettingsProvider.setUserSettings(t)}}return(i=g).\u0275fac=function(o){return new(o||i)(n.rXU(C.Qq),n.rXU(p.nX),n.rXU(p.Ix),n.rXU(k.u),n.rXU(R.p),n.rXU(m.w),n.rXU(I.$),n.rXU(u.d),n.rXU(x.J),n.rXU(s.W3),n.rXU(L.B),n.rXU(M.I),n.rXU(f.T))},i.\u0275cmp=n.VBU({type:i,selectors:[["app-page-login"]],decls:13,vars:6,consts:[[3,"translucent"],["pageTitle","LOGIN_TITLE"],["slot","fixed","vertical","top","horizontal","end",3,"click",4,"ngIf"],[1,"splash-bg"],[1,"splash-info"],[1,"splash-logo"],[1,"splash-intro"],[1,"ion-padding","ion-text-center"],[4,"ngIf"],["class","ion-margin-top",4,"ngIf"],["slot","fixed","vertical","top","horizontal","end",3,"click"],["color","action"],["name","help"],["size","large","fill","outline","expand","block",3,"click"],[1,"ion-margin-top"],["size","large","fill","outline","expand","block","class","btn-bankid",3,"click",4,"ngIf"],["size","large","fill","outline","expand","block",3,"click",4,"ngIf"],["size","large","fill","outline","expand","block",1,"btn-bankid",3,"click"],["src","assets/BankID/screen/bankid_vector_rgb.svg"],[1,"bankid"]],template:function(o,t){1&o&&(n.j41(0,"ion-header",0),n.nrm(1,"app-login-header",1),n.k0s(),n.j41(2,"ion-content"),n.DNE(3,D,3,0,"ion-fab",2),n.nrm(4,"div",3),n.j41(5,"div",4),n.nrm(6,"div",5),n.j41(7,"div",6),n.EFF(8),n.k0s()(),n.j41(9,"div",7),n.DNE(10,U,4,3,"ng-container",8)(11,A,1,0,"q-spinner",9)(12,G,6,5,"ng-container",8),n.k0s()()),2&o&&(n.Y8G("translucent",!0),n.R7$(3),n.Y8G("ngIf",t.isSchoolSelected),n.R7$(5),n.SpI(" ",t.schoolName," "),n.R7$(2),n.Y8G("ngIf",!t.schoolName),n.R7$(),n.Y8G("ngIf",t.isLoadingLoginMethods),n.R7$(),n.Y8G("ngIf",t.schoolName))},dependencies:[a.bT,s.Jm,s.W9,s.Q8,s.YW,s.eU,s.iq,b.t,O.C,d.D9],styles:[".fab[large-icon][_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3.6rem;font-weight:700}ion-button[_ngcontent-%COMP%]{height:50px}.btn-bankid[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px}.btn-bankid[_ngcontent-%COMP%]   span.bankid[_ngcontent-%COMP%]{text-transform:none}.splash-bg[_ngcontent-%COMP%]{position:relative;background:url(splashbg.955e4b74da7577a0.png) no-repeat transparent;background-size:cover;height:42%;z-index:1;background-repeat:repeat-x;animation:_ngcontent-%COMP%_animatedBackground 120s linear infinite}@keyframes _ngcontent-%COMP%_animatedBackground{0%{background-position:0 0}to{background-position:100% 0}}.splash-info[_ngcontent-%COMP%]{position:relative;z-index:2;margin-top:-64px;text-align:center}.splash-logo[_ngcontent-%COMP%]{margin:auto;background:url(appicon.d89d062336d8dd5b.png) repeat transparent;background-size:100%;width:128px;height:128px}.splash-intro[_ngcontent-%COMP%]{font-size:18px;font-weight:700;max-width:80%;margin:auto}"]}),g})()}];let F=(()=>{var i;class g{}return(i=g).\u0275fac=function(o){return new(o||i)},i.\u0275mod=n.$C({type:i}),i.\u0275inj=n.G2t({imports:[p.iI.forChild($),p.iI]}),g})();var N=e(7019);let K=(()=>{var i;class g{}return(i=g).\u0275fac=function(o){return new(o||i)},i.\u0275mod=n.$C({type:i}),i.\u0275inj=n.G2t({imports:[a.MD,_.YN,s.bv,F,d.h,N.h]}),g})()},8775:(E,P,e)=>{e.d(P,{V:()=>s});var a=e(4438);let s=(()=>{var _;class p{transform(l){return(l=l?l.replace(/href\s*=\s*["']([^"']+)["']/gi,(n,u)=>`href="${u.replace(/\n|<[^>]+>/g,"")}"`):"")?l.replace(/\n/g,"<br/>"):""}}return(_=p).\u0275fac=function(l){return new(l||_)},_.\u0275pipe=a.EJ8({name:"nlHtml",type:_,pure:!0}),p})()},1204:(E,P,e)=>{e.d(P,{$:()=>R});var a=e(467),s=e(4438),_=e(4538),p=e(5320),c=e(9196),l=e(772),n=e(6186),u=e(2840),d=e(3656),S=e(2457),T=e(4840),C=e(7643),k=e(2618);let R=(()=>{var m;class I{constructor(L,M,f,b,O,D,U,A,W,V,y){this.loginSchool=L,this.token=M,this.userInfo=f,this.userSettings=b,this.loginStatus=O,this.roleService=D,this.platform=U,this.push=A,this.rolesProvider=W,this.moduleService=V,this.moduleSettingProvider=y}clearStudentCardPage(){this.studentCardPage&&this.studentCardPage.ngOnDestroy()}logout(){this.token.clearToken(),this.userInfo.clear(),this.rolesProvider.clear(),this.moduleSettingProvider.clear(),this.clearStudentCardPage(),this.loginStatus.setStatus(!1),(this.platform.is("capacitor")||this.platform.is("cordova"))&&this.push.removePushToken()}changeRole(L,M){var f=this;return(0,a.A)(function*(){const b=yield f.roleService.changeRole(L,M);yield f.token.updateToken(b),f.userInfo.refresh();let O=yield f.userInfo.init();f.loginStatus.setRole(O.roleName),f.moduleSettingProvider.updateModuleSettings()})()}logOutAndForgetSchool(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}logOutAndForgetSchoolAndSettings(){this.logout(),this.loginSchool.clearLoginSchool(),this.userSettings.clearUserSettings()}}return(m=I).\u0275fac=function(L){return new(L||m)(s.KVO(_.d),s.KVO(p.x),s.KVO(c.Z),s.KVO(l.w),s.KVO(n.B),s.KVO(u.W),s.KVO(d.OD),s.KVO(S.T),s.KVO(T.L),s.KVO(C.v),s.KVO(k.C))},m.\u0275prov=s.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),I})()}}]);